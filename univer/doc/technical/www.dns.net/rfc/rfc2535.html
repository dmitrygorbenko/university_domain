<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="GENERATOR" content="Mozilla/4.6 [en] (WinNT; I) [Netscape]">
   <meta name="Author" content="Mark Symons (bliksim9@yahoo.com)">
   <title>RFC2535: Domain Name System Security Extensions</title>
</head>
<body text="#000000" bgcolor="#FFFFFF" link="#0000EE" vlink="#551A8B" alink="#FF0000">
This RFC has been HTMLized
by hand by <a href="mailto:mark.symons@nms.za.eds.com">Mark Symons</a>,
and word-for-word correspondence to the source has not been verified.&nbsp;
The <a href="ftp://ftp.is.co.za/rfc/rfc2535.txt">original RFC</a> should
be regarded as being authoritative.
<br>
<hr WIDTH="100%">
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=3 WIDTH="100%" >
<tr>
<td>Network Working Group</td>

<td></td>

<td>D. Eastlake</td>
</tr>

<tr>
<td>Request for Comments: 2535</td>

<td></td>

<td>IBM</td>
</tr>

<tr>
<td>Obsoletes: <a href="rfc2065.html">2065</a></td>

<td></td>

<td>March 1999</td>
</tr>

<tr>
<td>Updates: <a href="rfc2181.html">2181</a>, <a href="rfc1035/rfc1035.html">1035</a>,
<a href="ftp://ftp.is.co.za/rfc/rfc1034.txt">1034</a></td>

<td></td>

<td></td>
</tr>

<tr>
<td>Category: Standards Track</td>

<td></td>

<td></td>
</tr>
</table>

<center>
<h1>
Domain Name System Security Extensions</h1></center>

<h2>
Status of this Memo</h2>
This document specifies an Internet standards track protocol for the Internet
community, and requests discussion and suggestions for improvements.&nbsp;
Please refer to the current edition of the "Internet Official Protocol
Standards" (STD 1) for the standardization state and status of this protocol.&nbsp;
Distribution of this memo is unlimited.
<br>&nbsp;
<h2>
Copyright Notice</h2>
Copyright (C) The Internet Society (1999).&nbsp; All Rights Reserved.
<br>&nbsp;
<h2>
<a NAME="Abstract"></a>Abstract</h2>
Extensions to the Domain Name System (DNS) are described that provide data
integrity and authentication to security aware resolvers and applications
through the use of cryptographic digital signatures. These digital signatures
are included in secured zones as resource records.&nbsp; Security can also
be provided through non-security aware DNS servers in some cases.
<p>The extensions provide for the storage of authenticated public keys
in the DNS.&nbsp; This storage of keys can support general public key distribution
services as well as DNS security.&nbsp; The stored keys enable security
aware resolvers to learn the authenticating key of zones in addition to
those for which they are initially configured. Keys associated with DNS
names can be retrieved to support other protocols.&nbsp; Provision is made
for a variety of key types and algorithms.
<p>In addition, the security extensions provide for the optional authentication
of DNS protocol transactions and requests.
<p>This document incorporates feedback on <a href="rfc2065.html">RFC 2065</a>
from early implementers and potential users.
<br>&nbsp;
<h2>
<a NAME="Acknowledgments"></a>Acknowledgments</h2>
The significant contributions and suggestions of the following persons
(in alphabetic order) to DNS security are gratefully acknowledged:
<p>&nbsp;&nbsp; James M. Galvin
<br>&nbsp;&nbsp; John Gilmore
<br>&nbsp;&nbsp; Olafur Gudmundsson
<br>&nbsp;&nbsp; Charlie Kaufman
<br>&nbsp;&nbsp; Edward Lewis
<br>&nbsp;&nbsp; Thomas Narten
<br>&nbsp;&nbsp; Radia J. Perlman
<br>&nbsp;&nbsp; Jeffrey I. Schiller
<br>&nbsp;&nbsp; Steven (Xunhua) Wang
<br>&nbsp;&nbsp; Brian Wellington
<br>&nbsp;
<h2>
Table of Contents</h2>
<b><a href="#Abstract">Abstract</a></b>
<br><b><a href="#Acknowledgments">Acknowledgments</a></b>
<br><b><a href="#1">1. Overview of Contents</a></b>
<br><b><a href="#2">2. Overview of the DNS Extensions</a></b>
<br>&nbsp;&nbsp;&nbsp; <a href="#2.1">2.1 Services Not Provided</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#2.2">2.2 Key Distribution</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#2.3">2.3 Data Origin Authentication and
Integrity</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#2.3.1">2.3.1
The SIG Resource Record</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#2.3.2">2.3.2
Authenticating Name and Type Non-existence</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#2.3.3">2.3.3
Special Considerations With Time-to-Live</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#2.3.4">2.3.4
Special Considerations at Delegation Points</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#2.3.5">2.3.5
Special Considerations with CNAME</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#2.3.6">2.3.6
Signers Other Than The Zone</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#2.4">2.4 DNS Transaction and Request Authentication</a>
<br><b><a href="#3">3. The KEY Resource Record</a></b>
<br>&nbsp;&nbsp;&nbsp; <a href="#3.1">3.1 KEY RDATA format</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#3.1.1">3.1.1
Object Types, DNS Names, and Keys</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#3.1.2">3.1.2
The KEY RR Flag Field</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#3.1.3">3.1.3
The Protocol Octet</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#3.2">3.2 The KEY Algorithm Number Specification</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#3.3">3.3 Interaction of Flags, Algorithm,
and Protocol Bytes</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#3.4">3.4 Determination of Zone Secure/Unsecured
Status</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#3.5">3.5 KEY RRs in the Construction of
Responses</a>
<br><b><a href="#4">4. The SIG Resource Record</a></b>
<br>&nbsp;&nbsp;&nbsp; <a href="#4.1">4.1 SIG RDATA Format</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#4.1.1">4.1.1
Type Covered Field</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#4.1.2">4.1.2
Algorithm Number Field</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#4.1.3">4.1.3
Labels Field</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#4.1.4">4.1.4
Original TTL Field</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#4.1.5">4.1.5
Signature Expiration and Inception Fields</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#4.1.6">4.1.6
Key Tag Field</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#4.1.7">4.1.7
Signer's Name Field</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#4.1.8">4.1.8
Signature Field</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<a href="#4.1.8.1">4.1.8.1 Calculating Transaction and Request SIGs</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#4.2">4.2 SIG RRs in the Construction of
Responses</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#4.3">4.3 Processing Responses and SIG
RRs</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#4.4">4.4 Signature Lifetime, Expiration,
TTLs, and Validity</a>
<br><b><a href="#5">5. Non-existent Names and Types</a></b>
<br>&nbsp;&nbsp;&nbsp; <a href="#5.1">5.1 The NXT Resource Record</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#5.2">5.2 NXT RDATA Format</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#5.3">5.3 Additional Complexity Due to
Wildcards</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#5.4">5.4 Example</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#5.5">5.5 Special Considerations at Delegation
Points</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#5.6">5.6 Zone Transfers</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#5.6.1">5.6.1
Full Zone Transfers</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#5.6.2">5.6.2
Incremental Zone Transfers</a>
<br><b><a href="#6">6. How to Resolve Securely and the AD and CD Bits</a></b>
<br>&nbsp;&nbsp;&nbsp; <a href="#6.1">6.1 The AD and CD Header Bits</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#6.2">6.2 Staticly Configured Keys</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#6.3">6.3 Chaining Through The DNS</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#6.3.1">6.3.1
Chaining Through KEYs</a>
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="#6.3.2">6.3.2
Conflicting Data</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#6.4">6.4 Secure Time</a>
<br><b><a href="#7">7. ASCII Representation of Security RRs</a></b>
<br>&nbsp;&nbsp;&nbsp; <a href="#7.1">7.1 Presentation of KEY RRs</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#7.2">7.2 Presentation of SIG RRs</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#7.3">7.3 Presentation of NXT RRs</a>
<br><b><a href="#8">8. Canonical Form and Order of Resource Records</a></b>
<br>&nbsp;&nbsp;&nbsp; <a href="#8.1">8.1 Canonical RR Form</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#8.2">8.2 Canonical DNS Name Order</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#8.3">8.3 Canonical RR Ordering Within
An RRset</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#8.4">8.4 Canonical Ordering of RR Types</a>
<br><b><a href="#9">9. Conformance</a></b>
<br>&nbsp;&nbsp;&nbsp; <a href="#9.1">9.1 Server Conformance</a>
<br>&nbsp;&nbsp;&nbsp; <a href="#9.2">9.2 Resolver Conformance</a>
<br><b><a href="#10">10. Security Considerations</a></b>
<br><b><a href="#11">11. IANA Considerations</a></b>
<br><b><a href="#References">References</a></b>
<br><b><a href="#Author">Author's Address</a></b>
<br><b><a href="#A">Appendix A: Base 64 Encoding</a></b>
<br><b><a href="#B">Appendix B: Changes from RFC 2065</a></b>
<br><b><a href="#C">Appendix C: Key Tag Calculation</a></b>
<br><b><a href="#Copyright">Full Copyright Statement</a></b>
<br>&nbsp;
<h2>
<a NAME="1"></a>1. Overview of Contents</h2>
This document standardizes extensions of the Domain Name System (DNS) protocol
to support DNS security and public key distribution. It assumes that the
reader is familiar with the Domain Name System, particularly as described
in RFCs <a href="ftp://ftp.is.co.za/rfc/rfc1033.txt">1033</a>,
<a href="ftp://ftp.is.co.za/rfc/rfc1034.txt">1034</a>,
<a href="rfc1035/rfc1035.html">1035</a>
and later RFCs. An earlier version of these extensions appears in <a href="rfc2065.html">RFC
2065</a>.&nbsp; This replacement for that RFC incorporates early implementation
experience and requests from&nbsp; potential users.
<p><a href="#2">Section 2</a> provides an overview of the extensions and
the key distribution, data origin authentication, and transaction and request
security they provide.
<p><a href="#3">Section 3</a> discusses the KEY resource record, its structure,
and use in DNS responses.&nbsp; These resource records represent the public
keys of entities named in the DNS and are used for key distribution.
<p><a href="#4">Section 4</a> discusses the SIG digital signature resource
record, its structure, and use in DNS responses.&nbsp; These resource records
are used to authenticate other resource records in the DNS and optionally
to authenticate DNS transactions and requests.
<p><a href="#5">Section 5</a> discusses the NXT resource record (RR) and
its use in DNS responses including full and incremental zone transfers.&nbsp;
The NXT RR permits authenticated denial of the existence of a name or of
an RR type for an existing name.
<p><a href="#6">Section 6</a> discusses how a resolver can be configured
with a starting key or keys and proceed to securely resolve DNS requests.
Interactions between resolvers and servers are discussed for various combinations
of security aware and security non-aware.&nbsp; Two additional DNS header
bits are defined for signaling between resolvers and servers.
<p><a href="#7">Section 7</a> describes the ASCII representation of the
security resource records for use in master files and elsewhere.
<p><a href="#8">Section 8</a> defines the canonical form and order of RRs
for DNS security purposes.
<p><a href="#9">Section 9</a> defines levels of conformance for resolvers
and servers.
<p><a href="#10">Section 10</a> provides a few paragraphs on overall security
considerations.
<p><a href="#11">Section 11</a> specified IANA considerations for allocation
of additional values of paramters defined in this document.
<p><a href="#A">Appendix A</a> gives details of base 64 encoding which
is used in the file representation of some RRs defined in this document.
<p><a href="#B">Appendix B</a> summarizes changes between this memo and
<a href="rfc2065.html">RFC
2065</a>.
<p><a href="#C">Appendix C</a> specified how to calculate the simple checksum
used as a key tag in most SIG RRs.
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED",&nbsp; "MAY", and "OPTIONAL" in this
document are to be interpreted as described in [<a href="ftp://ftp.is.co.za/rfc/rfc2119.txt">RFC2119</a>].
<br>&nbsp;
<h2>
<a NAME="2"></a>2. Overview of the DNS Extensions</h2>
The Domain Name System (DNS) protocol security extensions provide three
distinct services: key distribution as described in <a href="#2.2">Section
2.2</a> below, data origin authentication as described in <a href="#2.3">Section
2.3</a> below, and transaction and request authentication, described in
<a href="#2.4">Section
2.4</a> below.
<p>Special considerations related to "time to live", CNAMEs, and delegation
points are also discussed in <a href="#2.3">Section 2.3</a>.
<br>&nbsp;
<h3>
<a NAME="2.1"></a>2.1 Services Not Provided</h3>
It is part of the design philosophy of the DNS that the data in it is public
and that the DNS gives the same answers to all inquirers. Following this
philosophy, no attempt has been made to include any sort of access control
lists or other means to differentiate inquirers.
<p>No effort has been made to provide for any confidentiality for queries
or responses.&nbsp; (This service may be available via IPSEC [<a href="ftp://ftp.is.co.za/rfc/rfc2401.txt">RFC
2401</a>], TLS, or other security protocols.)
<p>Protection is not provided against denial of service.
<br>&nbsp;
<h3>
<a NAME="2.2"></a>2.2 Key Distribution</h3>
A resource record format is defined to associate keys with DNS names. This
permits the DNS to be used as a public key distribution mechanism in support
of DNS security itself and other protocols.
<p>The syntax of a KEY resource record (RR) is described in <a href="#3">Section
3</a>. It includes an algorithm identifier, the actual public key parameter(s),
and a variety of flags including those indicating the type of entity the
key is associated with and/or asserting that there is no key associated
with that entity.
<p>Under conditions described in <a href="#3.5">Section 3.5</a>, security
aware DNS servers will automatically attempt to return KEY resources as
additional information, along with those resource records actually requested,
to minimize the number of queries needed.
<br>&nbsp;
<h3>
<a NAME="2.3"></a>2.3 Data Origin Authentication and Integrity</h3>
Authentication is provided by associating with resource record sets (RRsets
[<a href="rfc2181.html">RFC 2181</a>]) in the DNS cryptographically generated
digital signatures. Commonly, there will be a single private key that authenticates
an entire zone but there might be multiple keys for different algorithms,
signers, etc. If a security aware resolver reliably learns a public key
of the zone, it can authenticate, for signed data read from that zone,
that it is properly authorized.&nbsp; The most secure implementation is
for the zone private key(s) to be kept off-line and used to re-sign all
of the records in the zone periodically.&nbsp; However, there are cases,
for example dynamic update [RFCs <a href="rfc2136.html">2136</a>, <a href="rfc2137.html">2137</a>],
where DNS private keys need to be on-line [<a href="rfc2541.html">RFC 2541</a>].
<p>The data origin authentication key(s) are associated with the zone and
not with the servers that store copies of the data.&nbsp; That means compromise
of a secondary server or, if the key(s) are kept off line, even the primary
server for a zone, will not necessarily affect the degree of assurance
that a resolver has that it can determine whether data is genuine.
<p>A resolver could learn a public key of a zone either by reading it from
the DNS or by having it staticly configured.&nbsp; To reliably learn a
public key by reading it from the DNS, the key itself must be signed with
a key the resolver trusts. The resolver must be configured with at least
a public key which authenticates one zone as a starting point. From there,
it can securely read public keys of other zones, if the intervening zones
in the DNS tree are secure and their signed keys accessible.
<p>Adding data origin authentication and integrity requires no change to
the "on-the-wire" DNS protocol beyond the addition of the signature resource
type and the key resource type needed for key distribution. (Data non-existence
authentication also requires the NXT RR as described in <a href="#2.3.2">2.3.2</a>.)&nbsp;
This service can be supported by existing resolver and caching server implementations
so long as they can support the additional resource types (see <a href="#9">Section
9</a>). The one exception is that CNAME referrals in a secure zone can
not be authenticated if they are from non-security aware servers (see <a href="#2.3.5">Section
2.3.5</a>).
<p>If signatures are separately retrieved and verified when retrieving
the information they authenticate, there will be more trips to the server
and performance will suffer.&nbsp; Security aware servers mitigate that
degradation by attempting to send the signature(s) needed (see <a href="#4.2">Section
4.2</a>).
<br>&nbsp;
<h4>
<a NAME="2.3.1"></a>2.3.1 The SIG Resource Record</h4>
The syntax of a SIG resource record (signature) is described in <a href="#4">Section
4</a>.&nbsp; It cryptographicly binds the RRset being signed to the signer
and a validity interval.
<p>Every name in a secured zone will have associated with it at least one
SIG resource record for each resource type under that name except for glue
address RRs and delegation point NS RRs.&nbsp; A security aware server
will attempt to return, with RRs retrieved, the corresponding SIGs.&nbsp;
If a server is not security aware, the resolver must retrieve all the SIG
records for a name and select the one or ones that sign the resource record
set(s) that resolver is interested in.
<br>&nbsp;
<h4>
<a NAME="2.3.2"></a>2.3.2 Authenticating Name and Type Non-existence</h4>
The above security mechanism only provides a way to sign existing RRsets
in a zone.&nbsp; "Data origin" authentication is not obviously provided
for the non-existence of a domain name in a zone or the non-existence of
a type for an existing name.&nbsp; This gap is filled by the NXT RR which
authenticatably asserts a range of non-existent names in a zone and the
non-existence of types for the existing name just before that range.
<p><a href="#5">Section 5</a> below covers the NXT RR.
<br>&nbsp;
<h4>
<a NAME="2.3.3"></a>2.3.3 Special Considerations With Time-to-Live</h4>
A digital signature will fail to verify if any change has occurred to the
data between the time it was originally signed and the time the signature
is verified.&nbsp; This conflicts with our desire to have the time-to-live
(TTL) field of resource records tick down while they are cached.
<p>This could be avoided by leaving the time-to-live out of the digital
signature, but that would allow unscrupulous servers to set arbitrarily
long TTL values undetected.&nbsp; Instead, we include the "original" TTL
in the signature and communicate that data along with the current TTL.
Unscrupulous servers under this scheme can manipulate the TTL but a security
aware resolver will bound the TTL value it uses at the original signed
value.&nbsp; Separately, signatures include a signature inception time
and a signature expiration time. A resolver that knows the absolute time
can determine securely whether a signature is in effect.&nbsp; It is not
possible to rely solely on the signature expiration as a substitute for
the TTL, however, since the TTL is primarily a database consistency mechanism
and non-security aware servers that depend on TTL must still be supported.
<br>&nbsp;
<h4>
<a NAME="2.3.4"></a>2.3.4 Special Considerations at Delegation Points</h4>
DNS security would like to view each zone as a unit of data completely
under the control of the zone owner with each entry (RRset) signed by a
special private key held by the zone manager. But the DNS protocol views
the leaf nodes in a zone, which are also the apex nodes of a subzone (i.e.,
delegation points), as "really" belonging to the subzone.&nbsp; These nodes
occur in two master files and might have RRs signed by both the upper and
lower zone's keys. A retrieval could get a mixture of these RRs and SIGs,
especially since one server could be serving both the zone above and below
a delegation point. [<a href="rfc2181.html">RFC 2181</a>]
<p>There MUST be a zone KEY RR, signed by its superzone, for every subzone
if the superzone is secure. This will normally appear in the subzone and
may also be included in the superzone.&nbsp; But, in the case of an unsecured
subzone which can not or will not be modified to add any security RRs,
a KEY declaring the subzone to be unsecured MUST appear with the superzone
signature in the superzone, if the superzone is secure. For all but one
other RR type the data from the subzone is more authoritative so only the
subzone KEY RR should be signed in the superzone if it appears there. The
NS and any glue address RRs SHOULD only be signed in the subzone. The SOA
and any other RRs that have the zone name as owner should appear only in
the subzone and thus are signed only there. The NXT RR type is the exceptional
case that will always appear differently and authoritatively in both the
superzone and subzone, if both are secure, as described in <a href="#5">Section
5</a>.
<br>&nbsp;
<h4>
<a NAME="2.3.5"></a>2.3.5 Special Considerations with CNAME</h4>
There is a problem when security related RRs with the same owner name as
a CNAME RR are retrieved from a non-security-aware server. In particular,
an initial retrieval for the CNAME or any other type may not retrieve any
associated SIG, KEY, or NXT RR. For retrieved types other than CNAME, it
will retrieve that type at the target name of the CNAME (or chain of CNAMEs)
and will also return the CNAME.&nbsp; In particular, a specific retrieval
for type SIG will not get the SIG,
<br>if any, at the original CNAME domain name but rather a SIG at the target
name.
<p>Security aware servers must be used to securely CNAME in DNS. Security
aware servers MUST (1) allow KEY, SIG, and NXT RRs along with CNAME RRs,
(2) suppress CNAME processing on retrieval of these types as well as on
retrieval of the type CNAME, and (3) automatically return SIG RRs authenticating
the CNAME or CNAMEs encountered in resolving a query.&nbsp; This is a change
from the previous DNS standard [RFCs <a href="ftp://ftp.is.co.za/rfc/rfc1034.txt">1034</a>/<a href="rfc1035/rfc1035.html">1035</a>]
which prohibited any other RR type at a node where a CNAME RR was present.
<br>&nbsp;
<h4>
<a NAME="2.3.6"></a>2.3.6 Signers Other Than The Zone</h4>
There are cases where the signer in a SIG resource record is other than
one of the private key(s) used to authenticate a zone.
<p>One is for support of dynamic update [<a href="rfc2136.html">RFC 2136</a>]
(or future requests which require secure authentication) where an entity
is permitted to authenticate/update its records [<a href="rfc2137.html">RFC
2137</a>] and the zone is operating in a mode where the zone key is not
on line. The public key of the entity must be present in the DNS and be
signed by a zone level key but the other RR(s) may be signed with the entity's
key.
<p>A second case is support of transaction and request authentication as
described in <a href="#2.4">Section 2.4</a>.
<p>In additions, signatures can be included on resource records within
the DNS for use by applications other than DNS. DNS related signatures
authenticate that data originated with the authority of a zone owner or
that a request or transaction originated with the relevant entity. Other
signatures can provide other types of assurances.
<br>&nbsp;
<h3>
<a NAME="2.4"></a>2.4 DNS Transaction and Request Authentication</h3>
The data origin authentication service described above protects retrieved
resource records and the non-existence of resource records but provides
no protection for DNS requests or for message headers.
<p>If header bits are falsely set by a bad server, there is little that
can be done.&nbsp; However, it is possible to add transaction authentication.&nbsp;
Such authentication means that a resolver can be sure it is at least getting
messages from the server it thinks it queried and that the response is
from the query it sent (i.e., that these messages have not been diddled
in transit).&nbsp; This is accomplished by optionally adding a special
SIG resource record at the end of the reply which digitally signs the concatenation
of the server's response and the resolver's query.
<p>Requests can also be authenticated by including a special SIG RR at
the end of the request.&nbsp; Authenticating requests serves no function
in older DNS servers and requests with a non-empty additional information
section produce error returns or may even be ignored by many of them. However,
this syntax for signing requests is defined as a way of authenticating
secure dynamic update requests [<a href="rfc2137.html">RFC 2137</a>] or
future requests requiring authentication.
<p>The private keys used in transaction security belong to the entity composing
the reply, not to the zone involved.&nbsp; Request authentication may also
involve the private key of the host or other entity composing the request
or other private keys depending on the request authority it is sought to
establish. The corresponding public key(s) are normally stored in and retrieved
from the DNS for verification.
<p>Because requests and replies are highly variable, message authentication
SIGs can not be pre-calculated.&nbsp; Thus it will be necessary to keep
the private key on-line, for example in software or in a directly connected
piece of hardware.
<br>&nbsp;
<h2>
<a NAME="3"></a>3. The KEY Resource Record</h2>
The KEY resource record (RR) is used to store a public key that is associated
with a Domain Name System (DNS) name.&nbsp; This can be the public key
of a zone, a user, or a host or other end entity. Security aware DNS implementations
MUST be designed to handle at least two simultaneously valid keys of the
same type associated with the same name.
<p>The type number for the KEY RR is 25.
<p>A KEY RR is, like any other RR, authenticated by a SIG RR.&nbsp; KEY
RRs must be signed by a zone level key.
<br>&nbsp;
<h3>
<a NAME="3.1"></a>3.1 KEY RDATA format</h3>
The RDATA for a KEY RR consists of flags, a protocol octet, the algorithm
number octet, and the public key itself.&nbsp; The format is as follows:
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3</tt>
<br><tt>&nbsp;0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8
9 0 1</tt>
<br><tt>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br><tt>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
flags&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|&nbsp;&nbsp;&nbsp; protocol&nbsp;&nbsp; |&nbsp;&nbsp; algorithm&nbsp;&nbsp;
|</tt>
<br><tt>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br><tt>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</tt>
<br><tt>/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
public key&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</tt>
<br><tt>/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</tt>
<br><tt>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|</tt>
<p>The KEY RR is not intended for storage of certificates and a separate
certificate RR has been developed for that purpose, defined in [<a href="rfc2538.html">RFC
2538</a>].
<p>The meaning of the KEY RR owner name, flags, and protocol octet are
described in <a href="#3.1.1">Sections 3.1.1 through 3.1.5 below</a>.&nbsp;
The flags and algorithm must be examined before any data following the
algorithm octet as they control the existence and format of any following
data. The algorithm and public key fields are described in <a href="#3.2">Section
3.2</a>. The format of the public key is algorithm dependent.
<p>KEY RRs do not specify their validity period but their authenticating
SIG RR(s) do as described in <a href="#4">Section 4</a> below.
<br>&nbsp;
<h4>
<a NAME="3.1.1"></a>3.1.1 Object Types, DNS Names, and Keys</h4>
The public key in a KEY RR is for the object named in the owner name.
<p>A DNS name may refer to three different categories of things.&nbsp;
For example, foo.host.example could be (1) a zone, (2) a host or other
end entity , or (3) the mapping into a DNS name of the user or account
foo@host.example.&nbsp; Thus, there are flag bits, as described below,
in the KEY RR to indicate with which of these roles the owner name and
public key are associated.&nbsp; Note that an appropriate zone KEY RR MUST
occur at the apex node of a secure zone and zone KEY RRs occur only at
delegation points.
<br>&nbsp;
<h4>
<a NAME="3.1.2"></a>3.1.2 The KEY RR Flag Field</h4>
In the "flags" field:
<p><tt>&nbsp; 0&nbsp;&nbsp; 1&nbsp;&nbsp; 2&nbsp;&nbsp; 3&nbsp;&nbsp; 4&nbsp;&nbsp;
5&nbsp;&nbsp; 6&nbsp;&nbsp; 7&nbsp;&nbsp; 8&nbsp;&nbsp; 9&nbsp;&nbsp; 0&nbsp;&nbsp;
1&nbsp;&nbsp; 2&nbsp;&nbsp; 3&nbsp;&nbsp; 4&nbsp;&nbsp; 5</tt>
<br><tt>+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</tt>
<br><tt>|&nbsp; A/C&nbsp; | Z | XT| Z | Z | NAMTYP| Z | Z | Z | Z |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
SIG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |</tt>
<br><tt>+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+</tt>
<p>Bit 0 and 1 are the key "type" bits whose values have the following
meanings:
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=2 WIDTH="100%" >
<tr ALIGN=LEFT VALIGN=TOP>
<td WIDTH="5%">10:</td>

<td>Use of the key is prohibited for authentication.</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>01:</td>

<td>Use of the key is prohibited for confidentiality.</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>00</td>

<td>Use of the key for authentication and/or confidentiality is permitted.
Note that DNS security makes use of keys for authentication only. Confidentiality
use flagging is provided for use of keys in other protocols. Implementations
not intended to support key distribution for confidentiality MAY require
that the confidentiality&nbsp; use prohibited bit be on for keys they serve.</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>11:</td>

<td>If both bits are one, the "no key" value, there is no key information
and the RR stops after the algorithm octet. By the use of this "no key"
value, a signed KEY RR can authenticatably assert that, for example, a
zone is not secured.&nbsp; See <a href="#3.4">section 3.4</a> below.</td>
</tr>
</table>

<p>Bits 2 is reserved and must be zero.
<p>Bits 3 is reserved as a flag extension bit.&nbsp; If it is a one, a
second 16 bit flag field is added after the algorithm octet and before
the key data.&nbsp; This bit MUST NOT be set unless one or more such additional
bits have been defined and are non-zero.
<p>Bits 4-5 are reserved and must be zero.
<p>Bits 6 and 7 form a field that encodes the name type. Field values have
the following meanings:
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=2 WIDTH="100%" >
<tr ALIGN=LEFT VALIGN=TOP>
<td WIDTH="5%">00:</td>

<td>indicates that this is a key associated with a "user" or "account"
at an end entity, usually a host.&nbsp; The coding of the owner name is
that used for the responsible individual mailbox in the SOA and RP RRs:
The owner name is the user name as the name of a node under the entity
name.&nbsp; For example, "j_random_user" on host.subdomain.example could
have a public key associated through a KEY RR with name
<br>j_random_user.host.subdomain.example.&nbsp; It could be used in a security
protocol where authentication of a user was desired.&nbsp; This key might
be useful in IP or other security for a user level service such a telnet,
ftp, rlogin, etc.</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>01:</td>

<td>indicates that this is a zone key for the zone whose name is the KEY
RR owner name.&nbsp; This is the public key used for the primary DNS security
feature of data origin authentication.&nbsp; Zone KEY RRs occur only at
delegation points.</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>10:</td>

<td>indicates that this is a key associated with the non-zone "entity"
whose name is the RR owner name.&nbsp; This will commonly be a host but
could, in some parts of the DNS tree, be some other type of entity such
as a telephone number [<a href="ftp://ftp.is.co.za/rfc/rfc1530.txt">RFC
1530</a>] or numeric IP address.&nbsp; This is the public key used in connection
with DNS request and transaction authentication services.&nbsp; It could
also be used in an IP-security protocol where authentication at the host,
rather than user, level was desired, such as
<br>routing, NTP, etc.&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>11:</td>

<td>reserved.</td>
</tr>
</table>

<p>Bits 8-11 are reserved and must be zero.
<p>Bits 12-15 are the "signatory" field.&nbsp; If non-zero, they indicate
that the key can validly sign things as specified in DNS dynamic update
[<a href="rfc2137.html">RFC 2137</a>].&nbsp; Note that zone keys (see bits
6 and 7 above) always have authority to sign any RRs in the zone regardless
of the value of the signatory field.
<h4>
<a NAME="3.1.3"></a>3.1.3 The Protocol Octet</h4>
It is anticipated that keys stored in DNS will be used in conjunction with
a variety of Internet protocols.&nbsp; It is intended that the protocol
octet and possibly some of the currently unused (must be zero) bits in
the KEY RR flags as specified in the future will be used to indicate a
key's validity for different protocols.
<p>The following values of the Protocol Octet are reserved as indicated:
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp; VALUE&nbsp;&nbsp; Protocol</tt>
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
-reserved</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;
TLS</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;
email</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp;
dnssec</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp;
IPSEC</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5-254&nbsp;&nbsp; - available for
assignment by IANA</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 255&nbsp;&nbsp;&nbsp;&nbsp; All</tt>
<p>In more detail:
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=2 WIDTH="100%" >
<tr ALIGN=LEFT VALIGN=TOP>
<td WIDTH="5%">1:</td>

<td>is reserved for use in connection with TLS.</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>2</td>

<td>is reserved for use in connection with email.</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>3</td>

<td>is used for DNS security.&nbsp; The protocol field SHOULD be set to
this value for zone keys and other keys used in DNS security. Implementations
that can determine that a key is a DNS security key by the fact that flags
label it a zone key or the signatory flag field is non-zero are NOT REQUIRED
to check the protocol field.</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>4</td>

<td>is reserved to refer to the Oakley/IPSEC [<a href="ftp://ftp.is.co.za/rfc/rfc2401.txt">RFC
2401</a>] protocol and indicates that this key is valid for use in conjunction
with that security standard.&nbsp; This key could be used in connection
with secured communication on behalf of an end entity or user whose name
is the owner name of the KEY RR if the entity or user flag bits are set.&nbsp;
The presence of a KEY resource with this protocol value is an assertion
that the host speaks Oakley/IPSEC.</td>
</tr>

<tr>
<td ALIGN=LEFT VALIGN=TOP>255</td>

<td>indicates that the key can be used in connection with any protocol
for which KEY RR protocol octet values have been defined.&nbsp; The use
of this value is discouraged and the use of different keys for different
protocols is encouraged.</td>
</tr>
</table>

<h3>
<a NAME="3.2"></a>3.2 The KEY Algorithm Number Specification</h3>
This octet is the key algorithm parallel to the same field for the SIG
resource as described in <a href="#4.1">Section 4.1</a>.&nbsp; The following
values are assigned:
<p><tt>VALUE&nbsp;&nbsp; Algorithm</tt>
<p><tt>&nbsp; 0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - reserved, see <a href="#11">Section
11</a></tt>
<br><tt>&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp; RSA/MD5 [<a href="rfc2537.html">RFC
2537</a>] - recommended</tt>
<br><tt>&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp; Diffie-Hellman [RFC 2539] - optional,
key only</tt>
<br><tt>&nbsp; 3&nbsp;&nbsp;&nbsp;&nbsp; DSA [<a href="rfc2536.html">RFC
2536</a>] - MANDATORY</tt>
<br><tt>&nbsp; 4&nbsp;&nbsp;&nbsp;&nbsp; reserved for elliptic curve crypto</tt>
<br><tt>5-251&nbsp;&nbsp;&nbsp; - available, see <a href="#11">Section
11</a></tt>
<br><tt>252&nbsp;&nbsp;&nbsp;&nbsp; reserved for indirect keys</tt>
<br><tt>253&nbsp;&nbsp;&nbsp;&nbsp; private - domain name (see below)</tt>
<br><tt>254&nbsp;&nbsp;&nbsp;&nbsp; private - OID (see below)</tt>
<br><tt>255&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; - reserved, see <a href="#11">Section
11</a></tt>
<p>Algorithm specific formats and procedures are given in separate documents.&nbsp;
The mandatory to implement for interoperability algorithm is number 3,
DSA.&nbsp; It is recommended that the RSA/MD5 algorithm, number 1, also
be implemented.&nbsp; Algorithm 2 is used to indicate Diffie-Hellman keys
and algorithm 4 is reserved for elliptic curve.
<p>Algorithm number 252 indicates an indirect key format where the actual
key material is elsewhere.&nbsp; This format is to be defined in a separate
document.
<p>Algorithm numbers 253 and 254 are reserved for private use and will
never be assigned a specific algorithm.&nbsp; For number 253, the public
key area and the signature begin with a wire encoded domain name. Only
local domain name compression is permitted.&nbsp; The domain name indicates
the private algorithm to use and the remainder of the public key area is
whatever is required by that algorithm.&nbsp; For number 254, the public
key area for the KEY RR and the signature begin with an unsigned length
byte followed by a BER encoded Object Identifier (ISO OID) of that length.&nbsp;
The OID indicates the private algorithm in use and the remainder of the
area is whatever is required by that algorithm.&nbsp; Entities should only
use domain names and OIDs they control to designate their private algorithms.
<p>Values 0 and 255 are reserved but the value 0 is used in the algorithm
field when that field is not used.&nbsp; An example is in a KEY RR with
the top two flag bits on, the "no-key" value, where no key is present.
<br>&nbsp;
<h3>
<a NAME="3.3"></a>3.3 Interaction of Flags, Algorithm, and Protocol Bytes</h3>
Various combinations of the no-key type flags, algorithm byte, protocol
byte, and any future assigned protocol indicating flags are possible.&nbsp;
The meaning of these combinations is indicated below:
<p>NK = no key type (flags bits 0 and 1 on)
<br>AL = algorithm byte
<br>PR = protocols indicated by protocol byte or future assigned flags
<p>x represents any valid non-zero value(s).
<p><tt>&nbsp;AL&nbsp; PR&nbsp;&nbsp; NK&nbsp; Meaning</tt>
<br><tt>&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp; Illegal, claims
key but has bad algorithm field.</tt>
<br><tt>&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp; 1&nbsp;&nbsp; Specifies total
lack of security for owner zone.</tt>
<br><tt>&nbsp; 0&nbsp;&nbsp; x&nbsp;&nbsp; 0&nbsp;&nbsp; Illegal, claims
key but has bad algorithm field.</tt>
<br><tt>&nbsp; 0&nbsp;&nbsp; x&nbsp;&nbsp; 1&nbsp;&nbsp; Specified protocols
unsecured, others may be secure.</tt>
<br><tt>&nbsp; x&nbsp;&nbsp; 0&nbsp;&nbsp; 0&nbsp;&nbsp; Gives key but
no protocols to use it.</tt>
<br><tt>&nbsp; x&nbsp;&nbsp; 0&nbsp;&nbsp; 1&nbsp;&nbsp; Denies key for
specific algorithm.</tt>
<br><tt>&nbsp; x&nbsp;&nbsp; x&nbsp;&nbsp; 0&nbsp;&nbsp; Specifies key
for protocols.</tt>
<br><tt>&nbsp; x&nbsp;&nbsp; x&nbsp;&nbsp; 1&nbsp;&nbsp; Algorithm not
understood for protocol.</tt>
<br>&nbsp;
<h3>
<a NAME="3.4"></a>3.4 Determination of Zone Secure/Unsecured Status</h3>
A zone KEY RR with the "no-key" type field value (both key type flag bits
0 and 1 on) indicates that the zone named is unsecured while a zone KEY
RR with a key present indicates that the zone named is secure.&nbsp; The
secured versus unsecured status of a zone may vary with different cryptographic
algorithms.&nbsp; Even for the same algorithm, conflicting zone KEY RRs
may be present.
<p>Zone KEY RRs, like all RRs, are only trusted if they are authenticated
by a SIG RR whose signer field is a signer for which the resolver has a
public key they trust and where resolver policy permits that signer to
sign for the KEY owner name.&nbsp; Untrusted zone KEY RRs MUST be ignored
in determining the security status of the zone.&nbsp; However, there can
be multiple sets of trusted zone KEY RRs for a zone with different algorithms,
signers, etc.
<p>For any particular algorithm, zones can be (1) secure, indicating that
any retrieved RR must be authenticated by a SIG RR or it will be discarded
as bogus, (2) unsecured, indicating that SIG RRs are not expected or required
for RRs retrieved from the zone, or (3) experimentally secure, which indicates
that SIG RRs might or might not be present but must be checked if found.&nbsp;
The status of a zone is determined as follows:
<p>1.&nbsp; If, for a zone and algorithm, every trusted zone KEY RR for
the&nbsp; zone says there is no key for that zone, it is unsecured for
that algorithm.
<p>2.&nbsp; If, there is at least one trusted no-key zone KEY RR and one&nbsp;
trusted key specifying zone KEY RR, then that zone is only experimentally
secure for the algorithm.&nbsp; Both authenticated and&nbsp; non-authenticated
RRs for it should be accepted by the resolver.
<p>3.&nbsp; If every trusted zone KEY RR that the zone and algorithm has
is key specifying, then it is secure for that algorithm and only authenticated
RRs from it will be accepted.
<p>Examples:
<p>(1)&nbsp; A resolver initially trusts only signatures by the superzone
of zone Z within the DNS hierarchy.&nbsp; Thus it will look only at the
KEY RRs that are signed by the superzone.&nbsp; If it finds only no-key
KEY RRs, it will assume the zone is not secure.&nbsp; If it finds only
key specifying KEY RRs, it will assume the zone is secure and reject any
unsigned responses.&nbsp; If it finds both, it will assume the zone is
experimentally secure
<p>(2)&nbsp; A resolver trusts the superzone of zone Z (to which it got
securely from its local zone) and a third party, cert-auth.example. When
considering data from zone Z, it may be signed by the superzone of Z, by
cert-auth.example, by both, or by neither.&nbsp; The following table indicates
whether zone Z will be considered secure,
<br>experimentally secure, or unsecured, depending on the signed zone KEY
RRs for Z;
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
c e r t - a u t h . e x a m p l e</tt>
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp; KEY RRs|&nbsp;&nbsp; None&nbsp;&nbsp;&nbsp;
|&nbsp; NoKeys&nbsp;&nbsp; |&nbsp; Mixed&nbsp;&nbsp; |&nbsp;&nbsp; Keys&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp; S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --+-----------+-----------+----------+----------+</tt>
<br><tt>&nbsp; u&nbsp; None&nbsp;&nbsp; | illegal&nbsp;&nbsp; | unsecured
| experim. | secure&nbsp;&nbsp; |</tt>
<br><tt>&nbsp; p&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --+-----------+-----------+----------+----------+</tt>
<br><tt>&nbsp; e&nbsp; NoKeys | unsecured | unsecured | experim. | secure&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp; r&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --+-----------+-----------+----------+----------+</tt>
<br><tt>&nbsp; Z&nbsp; Mixed&nbsp; | experim.&nbsp; | experim.&nbsp; |
experim. | secure&nbsp;&nbsp; |</tt>
<br><tt>&nbsp; o&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; --+-----------+-----------+----------+----------+</tt>
<br><tt>&nbsp; n&nbsp; Keys&nbsp;&nbsp; | secure&nbsp;&nbsp;&nbsp; | secure&nbsp;&nbsp;&nbsp;
| secure&nbsp;&nbsp; | secure&nbsp;&nbsp; |</tt>
<br><tt>&nbsp; e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +-----------+-----------+----------+----------+</tt>
<br>&nbsp;
<h3>
<a NAME="3.5"></a>3.5 KEY RRs in the Construction of Responses</h3>
An explicit request for KEY RRs does not cause any special additional information
processing except, of course, for the corresponding SIG RR from a security
aware server (see <a href="#4.2">Section 4.2</a>).
<p>Security aware DNS servers include KEY RRs as additional information
in responses, where a KEY is available, in the following cases:
<p>(1) On the retrieval of SOA or NS RRs, the KEY RRset with the same name
(perhaps just a zone key) SHOULD be included as additional information
if space is available. If not all additional information will fit, type
A and AAAA glue RRs have higher priority than KEY RR(s).
<p>(2) On retrieval of type A or AAAA RRs, the KEY RRset with the same
name (usually just a host RR and NOT the zone key (which usually would
have a different name)) SHOULD be included if space is available.&nbsp;
On inclusion of A or AAAA RRs as additional information, the KEY RRset
with the same name should also be included but with lower priority than
the A or AAAA RRs.
<br>&nbsp;
<h2>
<a NAME="4"></a>4. The SIG Resource Record</h2>
The SIG or "signature" resource record (RR) is the fundamental way that
data is authenticated in the secure Domain Name System (DNS). As such it
is the heart of the security provided.
<p>The SIG RR unforgably authenticates an RRset [<a href="rfc2181.html">RFC
2181</a>] of a particular type, class, and name and binds it to a time
interval and the signer's domain name.&nbsp; This is done using cryptographic
techniques and the signer's private key.&nbsp; The signer is frequently
the owner of the zone from which the RR originated.
<p>The type number for the SIG RR type is 24.
<br>&nbsp;
<h3>
<a NAME="4.1"></a>4.1 SIG RDATA Format</h3>
The RDATA portion of a SIG RR is as shown below.&nbsp; The integrity of
the RDATA information is protected by the signature field.
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3</tt>
<br><tt>&nbsp;&nbsp;&nbsp; 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
2 3 4 5 6 7 8 9 0 1</tt>
<br><tt>&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br><tt>&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; type covered&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|&nbsp; algorithm&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp; labels&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br><tt>&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
original TTL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br><tt>&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
signature expiration&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br><tt>&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
signature inception&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br><tt>&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
key&nbsp; tag&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
signer's name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +</tt>
<br><tt>&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</tt>
<br><tt>&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-/</tt>
<br><tt>&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</tt>
<br><tt>&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
signature&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</tt>
<br><tt>&nbsp;&nbsp; /&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</tt>
<br><tt>&nbsp;&nbsp; +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br>&nbsp;
<h4>
<a NAME="4.1.1"></a>4.1.1 Type Covered Field</h4>
The "type covered" is the type of the other RRs covered by this SIG.
<br>&nbsp;
<h4>
<a NAME="4.1.2"></a>4.1.2 Algorithm Number Field</h4>
This octet is as described in <a href="#3.2">section 3.2</a>.
<br>&nbsp;
<h4>
<a NAME="4.1.3"></a>4.1.3 Labels Field</h4>
The "labels" octet is an unsigned count of how many labels there are in
the original SIG RR owner name not counting the null label for root and
not counting any initial "*" for a wildcard.&nbsp; If a secured retrieval
is the result of wild card substitution, it is necessary for the resolver
to use the original form of the name in verifying the digital signature.&nbsp;
This field makes it easy to determine the original form.
<p>If, on retrieval, the RR appears to have a longer name than indicated
by "labels", the resolver can tell it is the result of wildcard substitution.&nbsp;
If the RR owner name appears to be shorter than the labels count, the SIG
RR must be considered corrupt and ignored.&nbsp; The maximum number of
labels allowed in the current DNS is 127 but the entire octet is reserved
and would be required should DNS names ever be expanded to 255 labels.&nbsp;
The following table gives some examples. The value of "labels" is at the
top, the retrieved owner name on the left, and the table entry is the name
to use in signature verification except that "bad" means the RR is corrupt.
<br>&nbsp;
<p><tt>labels= |&nbsp; 0&nbsp; |&nbsp;&nbsp; 1&nbsp; |&nbsp;&nbsp;&nbsp;
2&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
4&nbsp;&nbsp; |</tt>
<br><tt>--------+-----+------+--------+----------+----------+</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; .|&nbsp;&nbsp; . | bad&nbsp;
|&nbsp; bad&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; bad&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;
bad&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; d.|&nbsp; *. |&nbsp;&nbsp; d. |&nbsp;
bad&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; bad&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;
bad&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp; c.d.|&nbsp; *. | *.d. |&nbsp;&nbsp; c.d. |&nbsp;&nbsp;&nbsp;
bad&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp; bad&nbsp;&nbsp; |</tt>
<br><tt>&nbsp; b.c.d.|&nbsp; *. | *.d. | *.c.d. |&nbsp;&nbsp; b.c.d. |&nbsp;&nbsp;&nbsp;
bad&nbsp;&nbsp; |</tt>
<br><tt>a.b.c.d.|&nbsp; *. | *.d. | *.c.d. | *.b.c.d. | a.b.c.d. |</tt>
<br>&nbsp;
<h4>
<a NAME="4.1.4"></a>4.1.4 Original TTL Field</h4>
The "original TTL" field is included in the RDATA portion to avoid (1)
authentication problems that caching servers would otherwise cause by decrementing
the real TTL field and (2) security problems that unscrupulous servers
could otherwise cause by manipulating the real TTL field.&nbsp; This original
TTL is protected by the signature while the current TTL field is not.
<p>NOTE:&nbsp; The "original TTL" must be restored into the covered RRs
when the signature is verified (see <a href="#8">Section 8</a>).&nbsp;
This generaly implies that all RRs for a particular type, name, and class,
that is, all the RRs in any particular RRset, must have the same TTL to
start with.
<br>&nbsp;
<h4>
<a NAME="4.1.5"></a>4.1.5 Signature Expiration and Inception Fields</h4>
The SIG is valid from the "signature inception" time until the "signature
expiration" time.&nbsp; Both are unsigned numbers of seconds since the
start of 1 January 1970, GMT, ignoring leap seconds.&nbsp; (See also <a href="#4.4">Section
4.4</a>.)&nbsp; Ring arithmetic is used as for DNS SOA serial numbers [<a href="rfc1982.html">RFC
1982</a>] which means that these times can never be more than about 68
years in the past or the future.&nbsp; This means that these times are
ambiguous modulo ~136.09 years.&nbsp; However there is no security flaw
because keys are required to be changed to new random keys by [<a href="rfc2541.html">RFC
2541</a>] at least every five years.&nbsp; This means that the probability
that the same key is in use N*136.09 years later should be the same as
the probability that a random guess will work.
<p>A SIG RR may have an expiration time numerically less than the inception
time if the expiration time is near the 32 bit wrap around point and/or
the signature is long lived.
<p>(To prevent misordering of network requests to update a zone dynamically,
monotonically increasing "signature inception" times may be necessary.)
<p>A secure zone must be considered changed for SOA serial number purposes
not only when its data is updated but also when new SIG RRs are inserted
(ie, the zone or any part of it is re-signed).
<br>&nbsp;
<h4>
<a NAME="4.1.6"></a>4.1.6 Key Tag Field</h4>
The "key Tag" is a two octet quantity that is used to efficiently select
between multiple keys which may be applicable and thus check that a public
key about to be used for the computationally expensive effort to check
the signature is possibly valid.&nbsp; For algorithm 1 (MD5/RSA) as defined
in [<a href="rfc2537.html">RFC 2537</a>], it is the next to the bottom
two octets of the public key modulus needed to decode the signature field.&nbsp;
That is to say, the most significant 16 of the least significant 24 bits
of the modulus in network (big endian) order. For all other algorithms,
including private algorithms, it is calculated as a simple checksum of
the KEY RR as described in Appendix C.
<br>&nbsp;
<h3>
<a NAME="4.1.7"></a>4.1.7 Signer's Name Field</h3>
The "signer's name" field is the domain name of the signer generating the
SIG RR.&nbsp; This is the owner name of the public KEY RR that can be used
to verify the signature.&nbsp; It is frequently the zone which contained
the RRset being authenticated.&nbsp; Which signers should be authorized
to sign what is a significant resolver policy question as discussed in
<a href="#6">Section
6</a>. The signer's name may be compressed with standard DNS name compression
when being transmitted over the
<br>network.
<br>&nbsp;
<h4>
<a NAME="4.1.8"></a>4.1.8 Signature Field</h4>
The actual signature portion of the SIG RR binds the other RDATA fields
to the RRset of the "type covered" RRs with that owner name and class.&nbsp;
This covered RRset is thereby authenticated.&nbsp; To accomplish this,
a data sequence is constructed as follows:
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; data = RDATA | RR(s)...
<p>where "|" is concatenation,
<p>RDATA is the wire format of all the RDATA fields in the SIG RR itself
(including the canonical form of the signer's name) before but not including
the signature, and
<p>RR(s) is the RRset of the RR(s) of the type covered with the same owner
name and class as the SIG RR in canonical form and order as defined in
Section <a href="#8">8</a>.
<p>How this data sequence is processed into the signature is algorithm
dependent.&nbsp; These algorithm dependent formats and procedures are described
in separate documents (<a href="#3.2">Section 3.2</a>).
<p>SIGs SHOULD NOT be included in a zone for any "meta-type" such as ANY,
AXFR, etc. (but see <a href="#5.6.2">section 5.6.2</a> with regard to IXFR).
<br>&nbsp;
<h5>
<a NAME="4.1.8.1"></a>4.1.8.1 Calculating Transaction and Request SIGs</h5>
A response message from a security aware server may optionally contain
a special SIG at the end of the additional information section to authenticate
the transaction.
<p>This SIG has a "type covered" field of zero, which is not a valid RR
type.&nbsp; It is calculated by using a "data" (see <a href="#4.1.8">Section
4.1.8</a>) of the entire preceding DNS reply message, including DNS header
but not the IP header and before the reply RR counts have been adjusted
for the inclusion of any transaction SIG, concatenated with the entire
DNS query message that produced this response, including the query's DNS
header and any request SIGs but not its IP header.&nbsp; That is
<p>&nbsp;&nbsp; data = full response (less transaction SIG) | full query
<p>Verification of the transaction SIG (which is signed by the server host
key, not the zone key) by the requesting resolver shows that the query
and response were not tampered with in transit, that the response corresponds
to the intended query, and that the response comes from the queried server.
<p>A DNS request may be optionally signed by including one or more SIGs
at the end of the query. Such SIGs are identified by having a "type covered"
field of zero. They sign the preceding DNS request message including DNS
header but not including the IP header or any request SIGs at the end and
before the request RR counts have been adjusted for the inclusions of any
request SIG(s).
<p>WARNING: Request SIGs are unnecessary for any currently defined request
other than update [RFC <a href="rfc2136.html">2136</a>, <a href="rfc2137.html">2137</a>]
and will cause some old DNS servers to give an error return or ignore a
query.&nbsp; However, such SIGs may in the future be needed for other requests.
<p>Except where needed to authenticate an update or similar privileged
request, servers are not required to check request SIGs.
<br>&nbsp;
<h3>
<a NAME="4.2"></a>4.2 SIG RRs in the Construction of Responses</h3>
Security aware DNS servers SHOULD, for every authenticated RRset the query
will return, attempt to send the available SIG RRs which authenticate the
requested RRset.&nbsp; The following rules apply to the inclusion of SIG
RRs in responses:
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=2 WIDTH="100%" >
<tr ALIGN=LEFT VALIGN=TOP>
<td WIDTH="5%">1.</td>

<td>when an RRset is placed in a response, its SIG RR has a higher priority
for inclusion than additional RRs that may need to be included.&nbsp; If
space does not permit its inclusion, the response MUST be considered truncated
except as provided in 2 below.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>2.</td>

<td>When a SIG RR is present in the zone for an additional information
section RR, the response MUST NOT be considered truncated merely because
space does not permit the inclusion of the SIG RR with the additional information.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>3.</td>

<td>SIGs to authenticate glue records and NS RRs for subzones at a delegation
point are unnecessary and MUST NOT be sent.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>4.</td>

<td>If a SIG covers any RR that would be in the answer section of the response,
its automatic inclusion MUST be in the answer section.&nbsp; If it covers
an RR that would appear in the authority section, its automatic inclusion
MUST be in the authority section.&nbsp; If it covers an RR that would appear
in the additional information section it MUST appear in the additional
information section.&nbsp; This is a change in the existing standard [RFCs
<a href="ftp://ftp.is.co.za/rfc/rfc1034.txt">1034</a>, <a href="rfc1035/rfc1035.html">1035</a>]
which contemplates only NS and SOA RRs in the authority section.
<br>&nbsp;</td>
</tr>

<tr>
<td ALIGN=LEFT VALIGN=TOP>5.</td>

<td>Optionally, DNS transactions may be authenticated by a SIG RR at the
end of the response in the additional information section (<a href="#4.1.8.1">Section
4.1.8.1</a>).&nbsp; Such SIG RRs are signed by the DNS server originating
the response.&nbsp; Although the signer field MUST be a name of the originating
server host, the owner name, class, TTL, and original TTL, are meaningless.&nbsp;
The class and TTL fields SHOULD be zero.&nbsp; To conserve space, the owner
name SHOULD be root (a single zero octet).&nbsp; If transaction authentication
is desired, that SIG RR must be considered the highest priority for inclusion.</td>
</tr>
</table>

<h3>
<a NAME="4.3"></a>4.3 Processing Responses and SIG RRs</h3>
The following rules apply to the processing of SIG RRs included in a response:
<br>&nbsp;
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=2 WIDTH="100%" >
<tr ALIGN=LEFT VALIGN=TOP>
<td WIDTH="5%">1.</td>

<td>A security aware resolver that receives a response from a security
aware server via a secure communication with the AD bit (see <a href="#6.1">Section
6.1</a>) set, MAY choose to accept the RRs as received without verifying
the zone SIG RRs.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>2.</td>

<td>In other cases, a security aware resolver SHOULD verify the SIG RRs
for the RRs of interest.&nbsp; This may involve initiating additional queries
for SIG or KEY RRs, especially in the case of getting a response from a
server that does not implement security.&nbsp; (As explained in <a href="#2.3.5">2.3.5</a>
above, it will not be possible to secure CNAMEs being served up by non-secure
resolvers.)
<p>NOTE: Implementers might expect the above SHOULD to be a MUST. However,
local policy or the calling application may not require the security services.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>3.</td>

<td>If SIG RRs are received in response to a user query explicitly specifying
the SIG type, no special processing is required.</td>
</tr>
</table>

<p>If the message does not pass integrity checks or the SIG does not check
against the signed RRs, the SIG RR is invalid and should be ignored.&nbsp;
If all of the SIG RR(s) purporting to authenticate an RRset are invalid,
then the RRset is not authenticated.
<p>If the SIG RR is the last RR in a response in the additional information
section and has a type covered of zero, it is a transaction signature of
the response and the query that produced the response.&nbsp; It MAY be
optionally checked and the message rejected if the checks fail.&nbsp; But
even if the checks succeed, such a transaction authentication SIG does
NOT directly authenticate any RRs in the message.&nbsp; Only a proper SIG
RR signed by the zone or a key tracing its authority to the zone or to
static resolver configuration can directly authenticate RRs, depending
on resolver policy (see <a href="#6">Section 6</a>).&nbsp; If a resolver
does not implement transaction and/or request SIGs, it MUST ignore them
without error.
<p>If all checks indicate that the SIG RR is valid then RRs verified by
it should be considered authenticated.
<br>&nbsp;
<h3>
<a NAME="4.4"></a>4.4 Signature Lifetime, Expiration, TTLs, and Validity</h3>
Security aware servers MUST NOT consider SIG RRs to authenticate anything
before their signature inception or after its expiration time (see also
<a href="#6">Section
6</a>).&nbsp; Security aware servers MUST NOT consider any RR to be authenticated
after all its signatures have expired. When a secure server caches authenticated
data, if the TTL would expire at a time further in the future than the
authentication expiration time, the server SHOULD trim the TTL in the cache
entry not to extent beyond the authentication expiration time.&nbsp; Within
these constraints, servers should continue to follow DNS TTL aging. Thus
authoritative servers should continue to follow the zone refresh and expire
parameters and a non-authoritative server should count down the TTL and
discard RRs when the TTL is zero (even for a SIG that has not yet reached
its authentication expiration time).&nbsp; In addition, when RRs are transmitted
in a query response, the TTL should be trimmed so that current time plus
the TTL does not extend beyond the authentication expiration time.&nbsp;
Thus, in general, the TTL on a transmitted RR would be
<p>&nbsp;&nbsp; min(authExpTim,max(zoneMinTTL,min(originalTTL,currentTTL)))
<p>When signatures are generated, signature expiration times should be
set far enough in the future that it is quite certain that new signatures
can be generated before the old ones expire.&nbsp; However, setting expiration
too far into the future could mean a long time to flush any bad data or
signatures that may have been generated.
<p>It is recommended that signature lifetime be a small multiple of the
TTL (ie, 4 to 16 times the TTL) but not less than a reasonable maximum
re-signing interval and not less than the zone expiry time.
<br>&nbsp;
<h2>
<a NAME="5"></a>5. Non-existent Names and Types</h2>
The SIG RR mechanism described in <a href="#4">Section 4</a> above provides
strong authentication of RRs that exist in a zone.&nbsp; But it is not
clear above how to verifiably deny the existence of a name in a zone or
a type for an existent name.
<p>The nonexistence of a name in a zone is indicated by the NXT ("next")
RR for a name interval containing the nonexistent name. An NXT RR or RRs
and its or their SIG(s) are returned in the authority section, along with
the error, if the server is security aware.&nbsp; The same is true for
a non-existent type under an existing name except that there is no error
indication other than an empty answer section accompanying the NXT(s).
This is a change in the existing standard [RFCs <a href="ftp://ftp.is.co.za/rfc/rfc1034.txt">1034</a>/<a href="rfc1035/rfc1035.html">1035</a>]
which contemplates only NS and SOA RRs in the authority section. NXT RRs
will also be returned if an explicit query is made for the NXT type.
<p>The existence of a complete set of NXT records in a zone means that
any query for any name and any type to a security aware server serving
the zone will result in an reply containing at least one signed RR unless
it is a query for delegation point NS or glue A or AAAA RRs.
<br>&nbsp;
<h3>
<a NAME="5.1"></a>5.1 The NXT Resource Record</h3>
The NXT resource record is used to securely indicate that RRs with an owner
name in a certain name interval do not exist in a zone and to indicate
what RR types are present for an existing name.
<p>The owner name of the NXT RR is an existing name in the zone.&nbsp;
It's RDATA is a "next" name and a type bit map. Thus the NXT RRs in a zone
create a chain of all of the literal owner names in that zone, including
unexpanded wildcards but omitting the owner name of glue address records
unless they would otherwise be included. This implies a canonical ordering
of all domain names in a zone as described in <a href="#8">Section 8</a>.
The presence of the NXT RR means that no name between its owner name and
the name in its RDATA area exists and that no other types exist under its
owner name.
<p>There is a potential problem with the last NXT in a zone as it wants
to have an owner name which is the last existing name in canonical order,
which is easy, but it is not obvious what name to put in its RDATA to indicate
the entire remainder of the name space.&nbsp; This is handled by treating
the name space as circular and putting the zone name in the RDATA of the
last NXT in a zone.
<p>The NXT RRs for a zone SHOULD be automatically calculated and added
to the zone when SIGs are added.&nbsp; The NXT RR's TTL SHOULD NOT exceed
the zone minimum TTL.
<p>The type number for the NXT RR is 30.
<p>NXT RRs are only signed by zone level keys.
<br>&nbsp;
<h3>
<a NAME="5.2"></a>5.2 NXT RDATA Format</h3>
The RDATA for an NXT RR consists simply of a domain name followed by a
bit map, as shown below.
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3</tt>
<br><tt>&nbsp;0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8
9 0 1</tt>
<br><tt>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br><tt>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
next domain name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</tt>
<br><tt>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<br><tt>|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
type bit map&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
/</tt>
<br><tt>+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+</tt>
<p>The NXT RR type bit map format currently defined is one bit per RR type
present for the owner name.&nbsp; A one bit indicates that at least one
RR of that type is present for the owner name.&nbsp; A zero indicates that
no such RR is present.&nbsp; All bits not specified because they are beyond
the end of the bit map are assumed to be zero.&nbsp; Note that bit 30,
for NXT, will always be on so the minimum bit map length is actually four
octets. Trailing zero octets are prohibited in this format.&nbsp; The first
bit represents RR type zero (an illegal type which can not be present)
and so will be zero in this format.&nbsp; This format is not used if there
exists an RR with a type number greater than 127.&nbsp; If the zero bit
of the type bit map is a one, it indicates that a different format is being
used which will always be the case if a
<br>type number greater than 127 is present.
<p>The domain name may be compressed with standard DNS name compression
when being transmitted over the network.&nbsp; The size of the bit map
can be inferred from the RDLENGTH and the length of the next domain name.
<br>&nbsp;
<h3>
<a NAME="5.3"></a>5.3 Additional Complexity Due to Wildcards</h3>
Proving that a non-existent name response is correct or that a wildcard
expansion response is correct makes things a little more complex.
<p>In particular, when a non-existent name response is returned, an NXT
must be returned showing that the exact name queried did not exist and,
in general, one or more additional NXT's need to be returned to also prove
that there wasn't a wildcard whose expansion should have been returned.
(There is no need to return multiple copies of the same NXT.) These NXTs,
if any, are returned in the authority section of the response.
<p>Furthermore, if a wildcard expansion is returned in a response, in general
one or more NXTs needs to also be returned in the authority section to
prove that no more specific name (including possibly more specific wildcards
in the zone) existed on which the response should have been based.
<br>&nbsp;
<h3>
<a NAME="5.4"></a>5.4 Example</h3>
Assume zone foo.nil has entries for
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; big.foo.nil,
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; medium.foo.nil.
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; small.foo.nil.
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; tiny.foo.nil.
<p>Then a query to a security aware server for huge.foo.nil would produce
an error reply with an RCODE of NXDOMAIN and the authority section data
including something like the following:
<p><tt>foo.nil.&nbsp;&nbsp;&nbsp; NXT big.foo.nil NS KEY SOA NXT ;prove
no *.foo.nil</tt>
<br><tt>foo.nil.&nbsp;&nbsp;&nbsp; SIG NXT 1 2 ( ;type-cov=NXT, alg=1,
labels=2</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
19970102030405 ;signature expiration</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
19961211100908 ;signature inception</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2143&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;key identifier</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
foo.nil.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;signer</tt>
<br><tt>AIYADP8d3zYNyQwW2EM4wXVFdslEJcUx/fxkfBeH1El4ixPFhpfHFElxbvKoWmvjDTCm</tt>
<br><tt>fiYy2X+8XpFjwICHc398kzWsTMKlxovpz2FnCTM= ;signature (640 bits)</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
)</tt>
<br><tt>big.foo.nil. NXT medium.foo.nil. A MX SIG NXT ;prove no huge.foo.nil</tt>
<br><tt>big.foo.nil. SIG NXT 1 3 ( ;type-cov=NXT, alg=1, labels=3</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
19970102030405 ;signature expiration</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
19961211100908 ;signature inception</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
2143&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;key identifier</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
foo.nil.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ;signer</tt>
<br><tt>&nbsp;MxFcby9k/yvedMfQgKzhH5er0Mu/vILz45IkskceFGgiWCn/GxHhai6VAuHAoNUz4YoU</tt>
<br><tt>&nbsp;1tVfSCSqQYn6//11U6Nld80jEeC8aTrO+KKmCaY= ;signature (640
bits)</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
)</tt>
<br>Note that this response implies that big.foo.nil is an existing name
in the zone and thus has other RR types associated with it than NXT. However,
only the NXT (and its SIG) RR appear in the response to this query for
huge.foo.nil, which is a non-existent name.
<br>&nbsp;
<h3>
<a NAME="5.5"></a>5.5 Special Considerations at Delegation Points</h3>
A name (other than root) which is the head of a zone also appears as the
leaf in a superzone.&nbsp; If both are secure, there will always be two
different NXT RRs with the same name.&nbsp; They can be easily distinguished
by their signers, the next domain name fields, the presence of the SOA
type bit, etc.&nbsp; Security aware servers should return the correct NXT
automatically when required to authenticate the non-existence of a name
and both NXTs, if available, on explicit query for type NXT.
<p>Non-security aware servers will never automatically return an NXT and
some old implementations may only return the NXT from the subzone on explicit
queries.
<br>&nbsp;
<h3>
<a NAME="5.6"></a>5.6 Zone Transfers</h3>
The subsections below describe how full and incremental zone transfers
are secured.
<p>SIG RRs secure all authoritative RRs transferred for both full and incremental
[<a href="rfc1995.html">RFC 1995</a>] zone transfers.&nbsp; NXT RRs are
an essential element in secure zone transfers and assure that every authoritative
name and type will be present; however, if there are multiple SIGs with
the same name and type covered, a subset of the SIGs could be sent as long
as at least one is present and, in the case of unsigned delegation point
NS or glue A or AAAA RRs a subset of these RRs or simply a modified set
could be sent as long as at least one of each type is included.
<p>When an incremental or full zone transfer request is received with the
same or newer version number than that of the server's copy of the zone,
it is replied to with just the SOA RR of the server's current version and
the SIG RRset verifying that SOA RR.
<p>The complete NXT chains specified in this document enable a resolver
to obtain, by successive queries chaining through NXTs, all of the names
in a zone even if zone transfers are prohibited.&nbsp; Different format
NXTs may be specified in the future to avoid this.
<br>&nbsp;
<h4>
<a NAME="5.6.1"></a>5.6.1 Full Zone Transfers</h4>

<p><br>To provide server authentication that a complete transfer has occurred,
transaction authentication SHOULD be used on full zone transfers.&nbsp;
This provides strong server based protection for the entire zone in transit.
<br>&nbsp;
<h4>
<a NAME="5.6.2"></a>5.6.2 Incremental Zone Transfers</h4>
Individual RRs in an incremental (IXFR) transfer [<a href="rfc1995.html">RFC
1995</a>] can be verified in the same way as for a full zone transfer and
the integrity of the NXT name chain and correctness of the NXT type bits
for the zone after the incremental RR deletes and adds can check each disjoint
area of the zone updated.&nbsp; But the completeness of an incremental
transfer can not be confirmed because usually neither the deleted RR section
nor the added RR section has a compete zone NXT chain.&nbsp; As a result,
a server which securely supports IXFR must handle IXFR SIG RRs for each
incremental transfer set that it maintains.
<p>The IXFR SIG is calculated over the incremental zone update collection
of RRs in the order in which it is transmitted: old SOA, then deleted RRs,
then new SOA and added RRs.&nbsp; Within each section, RRs must be ordered
as specified in <a href="#8">Section 8</a>.&nbsp; If condensation of adjacent
incremental update sets is done by the zone owner, the original IXFR SIG
for each set included in the condensation must be discarded and a new on
IXFR SIG calculated to cover the resulting condensed set.
<p>The IXFR SIG really belongs to the zone as a whole, not to the zone
name.&nbsp; Although it SHOULD be correct for the zone name, the labels
field of an IXFR SIG is otherwise meaningless.&nbsp; The IXFR SIG is only
sent as part of an incremental zone transfer.&nbsp; After validation of
the IXFR SIG, the transferred RRs MAY be considered valid without verification
of the internal SIGs if such trust in the server conforms to local policy.
<br>&nbsp;
<h2>
<a NAME="6"></a>6. How to Resolve Securely and the AD and CD Bits</h2>
Retrieving or resolving secure data from the Domain Name System (DNS) involves
starting with one or more trusted public keys that have been staticly configured
at the resolver.&nbsp; With starting trusted keys, a resolver willing to
perform cryptography can progress securely through the secure DNS structure
to the zone of interest as described in <a href="#6.3">Section 6.3</a>.
Such trusted public keys would normally be configured in a manner similar
to that described in <a href="#6.2">Section 6.2</a>.&nbsp; However, as
a practical matter, a security aware resolver would still gain some confidence
in the results it returns even if it was not configured with any keys but
trusted what it got from a local well known server as if it were staticly
configured.
<p>Data stored at a security aware server needs to be internally categorized
as Authenticated, Pending, or Insecure. There is also a fourth transient
state of Bad which indicates that all SIG checks have explicitly failed
on the data. Such Bad data is not retained at a security aware server.
Authenticated means that the data has a valid SIG under a KEY traceable
via a chain of zero or more SIG and KEY RRs allowed by the resolvers policies
to a KEY staticly configured at the resolver. Pending data has no authenticated
SIGs and at least one additional SIG the resolver is still trying to authenticate.&nbsp;
Insecure data is data which it is known can never be either Authenticated
or found Bad in the zone where it was found because it is in or has been
reached via a unsecured zone or because it is unsigned glue address or
delegation point NS data. Behavior in terms of control of and flagging
based on such data labels is described in <a href="#6.1">Section 6.1</a>.
<p>The proper validation of signatures requires a reasonably secure shared
opinion of the absolute time between resolvers and servers as described
in <a href="#6.4">Section 6.4</a>.
<br>&nbsp;
<h3>
<a NAME="6.1"></a>6.1 The AD and CD Header Bits</h3>
Two previously unused bits are allocated out of the DNS query/response
format header. The AD (authentic data) bit indicates in a response that
all the data included in the answer and authority portion of the response
has been authenticated by the server according to the policies of that
server. The CD (checking disabled) bit indicates in a query that Pending
(non-authenticated) data is acceptable to the resolver sending the query.
<p>These bits are allocated from the previously must-be-zero Z field as
follows:
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
1&nbsp; 1&nbsp; 1&nbsp; 1&nbsp; 1&nbsp; 1</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0&nbsp;
1&nbsp; 2&nbsp; 3&nbsp; 4&nbsp; 5&nbsp; 6&nbsp; 7&nbsp; 8&nbsp; 9&nbsp;
0&nbsp; 1&nbsp; 2&nbsp; 3&nbsp; 4&nbsp; 5</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |QR|&nbsp;&nbsp;
Opcode&nbsp; |AA|TC|RD|RA| Z|AD|CD|&nbsp;&nbsp; RCODE&nbsp;&nbsp; |</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
QDCOUNT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ANCOUNT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
NSCOUNT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ARCOUNT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
|</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</tt>
<p>These bits are zero in old servers and resolvers.&nbsp; Thus the responses
of old servers are not flagged as authenticated to security aware resolvers
and queries from non-security aware resolvers do not assert the checking
disabled bit and thus will be answered by security aware servers only with
Authenticated or Insecure data. Security aware resolvers MUST NOT trust
the AD bit unless they trust the server they are talking to and either
have a secure path to it or use DNS
<br>transaction security.
<p>Any security aware resolver willing to do cryptography SHOULD assert
the CD bit on all queries to permit it to impose its own policies and to
reduce DNS latency time by allowing security aware servers to answer with
Pending data.
<p>Security aware servers MUST NOT return Bad data.&nbsp; For non-security
aware resolvers or security aware resolvers requesting service by having
the CD bit clear, security aware servers MUST return only Authenticated
or Insecure data in the answer and authority sections with the AD bit set
in the response. Security aware servers SHOULD return Pending data, with
the AD bit clear in the response, to security aware resolvers requesting
this service by asserting the CD bit in their request.&nbsp; The AD bit
MUST NOT be set on a response unless all of the RRs in the answer and authority
sections of the response are either Authenticated or Insecure.&nbsp; The
AD bit does not cover the additional information section.
<br>&nbsp;
<h3>
<a NAME="6.2"></a>6.2 Staticly Configured Keys</h3>
The public key to authenticate a zone SHOULD be defined in local configuration
files before that zone is loaded at the primary server so the zone can
be authenticated.
<p>While it might seem logical for everyone to start with a public key
associated with the root zone and staticly configure this in every resolver,
this has problems.&nbsp; The logistics of updating every DNS resolver in
the world should this key ever change would be severe. Furthermore, many
organizations will explicitly wish their "interior" DNS implementations
to completely trust only their own DNS servers. Interior resolvers of such
organizations can then go through the organization's zone servers to access
data outside the organization's domain and need not be configured with
keys above the organization's
<br>DNS apex.
<p>Host resolvers that are not part of a larger organization may be configured
with a key for the domain of their local ISP whose recursive secure DNS
caching server they use.
<br>&nbsp;
<h3>
<a NAME="6.3"></a>6.3 Chaining Through The DNS</h3>
Starting with one or more trusted keys for any zone, it should be possible
to retrieve signed keys for that zone's subzones which have a key. A secure
sub-zone is indicated by a KEY RR with non-null key information appearing
with the NS RRs in the sub-zone and which may also be present in the parent.&nbsp;
These make it possible to descend within the tree of zones.
<br>&nbsp;
<h4>
<a NAME="6.3.1"></a>6.3.1 Chaining Through KEYs</h4>
In general, some RRset that you wish to validate in the secure DNS will
be signed by one or more SIG RRs.&nbsp; Each of these SIG RRs has a signer
under whose name is stored the public KEY to use in authenticating the
SIG.&nbsp; Each of those KEYs will, generally, also be signed with a SIG.&nbsp;
And those SIGs will have signer names also referring to KEYs.&nbsp; And
so on. As a result, authentication leads to chains of alternating SIG and
KEY RRs with the first SIG signing the original data whose authenticity
is to be shown and the final KEY being some trusted key staticly configured
at the resolver performing the authentication.
<p>In testing such a chain, the validity periods of the SIGs encountered
must be intersected to determine the validity period of the authentication
of the data, a purely algorithmic process. In addition, the validation
of each SIG over the data with reference to a KEY must meet the objective
cryptographic test implied by the cryptographic algorithm used (although
even here the resolver may have policies as to trusted algorithms and key
lengths).&nbsp; Finally, the judgement that a SIG with a particular signer
name can authenticate data (possibly a KEY RRset) with a particular owner
name, is primarily a policy question.&nbsp; Ultimately, this is a policy
local to the resolver and any clients that depend on that resolver's decisions.&nbsp;
It is, however, recommended, that the policy below be adopted:
<br>&nbsp;
<table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=2 WIDTH="100%" >
<tr ALIGN=LEFT VALIGN=TOP>
<td WIDTH="5%"></td>

<td>Let A &lt; B mean that A is a shorter domain name than B formed by
dropping one or more whole labels from the left end of B, i.e., A is a
direct or indirect superdomain of B.&nbsp; Let A = B mean that A and B
are the same domain name (i.e., are identical after letter case canonicalization).&nbsp;
Let A > B mean that A is a longer domain name than B formed by adding one
or more whole labels on the left end of B, i.e., A is a direct or indirect
subdomain of B
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td></td>

<td>Let Static be the owner names of the set of staticly configured trusted
keys at a resolver.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td></td>

<td>Then Signer is a valid signer name for a SIG authenticating an RRset
(possibly a KEY RRset) with owner name Owner at the resolver if any of
the following three rules apply:
<br>&nbsp;</td>
</tr>

<tr>
<td></td>

<td>(1) Owner > or = Signer (except that if Signer is root, Owner must
be root or a top level domain name).&nbsp; That is, Owner is the same as
or a subdomain of Signer.
<br>&nbsp;</td>
</tr>

<tr>
<td></td>

<td>(2) ( Owner &lt; Signer ) and ( Signer > or = some Static ).&nbsp;
That is, Owner is a superdomain of Signer and Signer is staticly configured
or a subdomain of a staticly configured key.
<br>&nbsp;</td>
</tr>

<tr>
<td></td>

<td>(3) Signer = some Static.&nbsp; That is, the signer is exactly some
staticly configured key.
<br>&nbsp;</td>
</tr>
</table>

<p>Rule 1 is the rule for descending the DNS tree and includes a special
prohibition on the root zone key due to the restriction that the root zone
be only one label deep.&nbsp; This is the most fundamental rule.
<p>Rule 2 is the rule for ascending the DNS tree from one or more staticly
configured keys.&nbsp; Rule 2 has no effect if only root zone keys are
staticly configured.
<p>Rule 3 is a rule permitting direct cross certification.&nbsp; Rule 3
has no effect if only root zone keys are staticly configured.
<p>Great care should be taken that the consequences have been fully considered
before making any local policy adjustments to these rules (other than dispensing
with rules 2 and 3 if only root zone keys are staticly configured).
<br>&nbsp;
<h4>
<a NAME="6.3.2"></a>6.3.2 Conflicting Data</h4>
It is possible that there will be multiple SIG-KEY chains that appear to
authenticate conflicting RRset answers to the same query.&nbsp; A resolver
should choose only the most reliable answer to return and discard other
data.&nbsp; This choice of most reliable is a matter of local policy which
could take into account differing trust in algorithms, key sizes, staticly
configured keys, zones traversed, etc.&nbsp; The technique given below
is recommended for taking into account SIG-KEY chain length.
<p>A resolver should keep track of the number of successive secure zones
traversed from a staticly configured key starting point to any secure zone
it can reach.&nbsp; In general, the lower such a distance number is, the
greater the confidence in the data.&nbsp; Staticly configured data should
be given a distance number of zero.&nbsp; If a query encounters different
Authenticated data for the same query with different distance values, that
with a larger value should be ignored unless some other local policy covers
the case.
<p>A security conscious resolver should completely refuse to step from
a secure zone into a unsecured zone unless the unsecured zone is certified
to be non-secure by the presence of an authenticated KEY RR for the unsecured
zone with the no-key type value.&nbsp; Otherwise the resolver is getting
bogus or spoofed data.
<p>If legitimate unsecured zones are encountered in traversing the DNS
tree, then no zone can be trusted as secure that can be reached only via
information from such non-secure zones. Since the unsecured zone data could
have been spoofed, the "secure" zone reached via it could be counterfeit.&nbsp;
The "distance" to data in such zones or zones reached via such zones could
be set to 256 or more as this exceeds the largest possible distance through
secure zones in the DNS.
<br>&nbsp;
<h3>
<a NAME="6.4"></a>6.4 Secure Time</h3>
Coordinated interpretation of the time fields in SIG RRs requires that
reasonably consistent time be available to the hosts implementing the DNS
security extensions.
<p>A variety of time synchronization protocols exist including the Network
Time Protocol (NTP [RFC <a href="ftp://ftp.is.co.za/rfc/rfc1305.txt">1305</a>,
<a href="ftp://ftp.is.co.za/rfc/rfc2030.txt">2030</a>]).&nbsp;
If such protocols are used, they MUST be used securely so that time can
not be spoofed.
<p>Otherwise, for example, a host could get its clock turned back and might
then believe old SIG RRs, and the data they authenticate, which were valid
but are no longer.
<br>&nbsp;
<h2>
<a NAME="7"></a>7. ASCII Representation of Security RRs</h2>
This section discusses the format for master file and other ASCII presentation
of the three DNS security resource records.
<p>The algorithm field in KEY and SIG RRs can be represented as either
an unsigned integer or symbolicly.&nbsp; The following initial symbols
are defined as indicated:
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp; Value&nbsp; Symbol</tt>
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp; 001&nbsp;&nbsp;&nbsp; RSAMD5</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 002&nbsp;&nbsp;&nbsp; DH</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 003&nbsp;&nbsp;&nbsp; DSA</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 004&nbsp;&nbsp;&nbsp; ECC</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 252&nbsp;&nbsp;&nbsp; INDIRECT</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 253&nbsp;&nbsp;&nbsp; PRIVATEDNS</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 254&nbsp;&nbsp;&nbsp; PRIVATEOID</tt>
<br>&nbsp;
<h3>
<a NAME="7.1"></a>7.1 Presentation of KEY RRs</h3>
KEY RRs may appear as single logical lines in a zone data master file [<a href="ftp://ftp.is.co.za/rfc/rfc1033.txt">RFC
1033</a>].
<p>The flag field is represented as an unsigned integer or a sequence of
mnemonics as follows separated by instances of the verticle bar ("|") character:
<p><tt>&nbsp; BIT&nbsp; Mnemonic&nbsp; Explanation</tt>
<br><tt>&nbsp;0-1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
key type</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; NOCONF&nbsp;&nbsp;&nbsp; =1 confidentiality
use prohibited</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; NOAUTH&nbsp;&nbsp;&nbsp; =2 authentication
use prohibited</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; NOKEY&nbsp;&nbsp;&nbsp;&nbsp; =3 no key
present</tt>
<br><tt>&nbsp;2&nbsp;&nbsp; FLAG2&nbsp;&nbsp;&nbsp;&nbsp; - reserved</tt>
<br><tt>&nbsp;3&nbsp;&nbsp; EXTEND&nbsp;&nbsp;&nbsp; flags extension</tt>
<br><tt>&nbsp;4&nbsp;&nbsp; FLAG4&nbsp;&nbsp;&nbsp;&nbsp; - reserved</tt>
<br><tt>&nbsp;5&nbsp;&nbsp; FLAG5&nbsp;&nbsp;&nbsp;&nbsp; - reserved</tt>
<br><tt>&nbsp;6-7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
name type</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; USER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =0
(default, may be omitted)</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; ZONE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =1</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; HOST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; =2
(host or other end entity)</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; NTYP3&nbsp;&nbsp;&nbsp;&nbsp; - reserved</tt>
<br><tt>&nbsp;8&nbsp;&nbsp; FLAG8&nbsp;&nbsp;&nbsp;&nbsp; - reserved</tt>
<br><tt>&nbsp;9&nbsp;&nbsp; FLAG9&nbsp;&nbsp;&nbsp;&nbsp; - reserved</tt>
<br><tt>10&nbsp;&nbsp; FLAG10&nbsp;&nbsp;&nbsp; - reserved</tt>
<br><tt>11&nbsp;&nbsp; FLAG11&nbsp;&nbsp;&nbsp; - reserved</tt>
<br><tt>12-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; signatory
field, values 0 to 15</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; can be represented
by SIG0, SIG1, ... SIG15</tt>
<p>No flag mnemonic need be present if the bit or field it represents is
zero.
<p>The protocol octet can be represented as either an unsigned integer
or symbolicly.&nbsp; The following initial symbols are defined:
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp; 000&nbsp;&nbsp;&nbsp; NONE</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 001&nbsp;&nbsp;&nbsp; TLS</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 002&nbsp;&nbsp;&nbsp; EMAIL</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 003&nbsp;&nbsp;&nbsp; DNSSEC</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 004&nbsp;&nbsp;&nbsp; IPSEC</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp; 255&nbsp;&nbsp;&nbsp; ALL</tt>
<p>Note that if the type flags field has the NOKEY value, nothing appears
after the algorithm octet.
<p>The remaining public key portion is represented in base 64 (see <a href="#A">Appendix
A</a>) and may be divided up into any number of white space separated substrings,
down to single base 64 digits, which are concatenated to obtain the full
signature.&nbsp; These substrings can span lines using the standard parenthesis.
<p>Note that the public key may have internal sub-fields but these do not
appear in the master file representation.&nbsp; For example, with algorithm
1 there is a public exponent size, then a public exponent, and then a modulus.&nbsp;
With algorithm 254, there will be an OID size, an OID, and algorithm dependent
information. But in both cases only a single logical base 64 string will
appear in the master file.
<br>&nbsp;
<h3>
<a NAME="7.2"></a>7.2 Presentation of SIG RRs</h3>
A data SIG RR may be represented as a single logical line in a zone data
file [<a href="ftp://ftp.is.co.za/rfc/rfc1033.txt">RFC 1033</a>] but there
are some special considerations as described below.&nbsp; (It does not
make sense to include a transaction or request authenticating SIG RR in
a file as they are a transient authentication that covers data including
an ephemeral transaction number and so must be calculated in real time.)
<p>There is no particular problem with the signer, covered type, and times.&nbsp;
The time fields appears in the form YYYYMMDDHHMMSS where YYYY is the year,
the first MM is the month number (01-12), DD is the day of the month (01-31),
HH is the hour in 24 hours notation (00-23), the second MM is the minute
(00-59), and SS is the second (00-59).
<p>The original TTL field appears as an unsigned integer.
<p>If the original TTL, which applies to the type signed, is the same as
the TTL of the SIG RR itself, it may be omitted.&nbsp; The date field which
follows it is larger than the maximum possible TTL so there is no ambiguity.
<p>The "labels" field appears as an unsigned integer.
<p>The key tag appears as an unsigned number.
<p>However, the signature itself can be very long.&nbsp; It is the last
data field and is represented in base 64 (see <a href="#A">Appendix A</a>)
and may be divided up into any number of white space separated substrings,
down to single base 64 digits, which are concatenated to obtain the full
signature.&nbsp; These substrings can be split between lines using the
standard parenthesis.
<br>&nbsp;
<h3>
<a NAME="7.3"></a>7.3 Presentation of NXT RRs</h3>
NXT RRs do not appear in original unsigned zone master files since they
should be derived from the zone as it is being signed.&nbsp; If a signed
file with NXTs added is printed or NXTs are printed by debugging code,
they appear as the next domain name followed by the RR type present bits
as an unsigned interger or sequence of RR mnemonics.
<br>&nbsp;
<h2>
<a NAME="8"></a>8. Canonical Form and Order of Resource Records</h2>
This section specifies, for purposes of domain name system (DNS) security,
the canonical form of resource records (RRs), their name order, and their
overall order.&nbsp; A canonical name order is necessary to construct the
NXT name chain.&nbsp; A canonical form and ordering within an RRset is
necessary in consistently constructing and verifying SIG RRs.&nbsp; A canonical
ordering of types within a name is required in connection with incremental
transfer (<a href="#5.6.2">Section 5.6.2</a>).
<br>&nbsp;
<h3>
<a NAME="8.1"></a>8.1 Canonical RR Form</h3>
For purposes of DNS security, the canonical form for an RR is the wire
format of the RR with domain names (1) fully expanded (no name compression
via pointers), (2) all domain name letters set to lower case, (3) owner
name wild cards in master file form (no substitution made for *), and (4)
the original TTL substituted for the current TTL.
<br>&nbsp;
<h3>
<a NAME="8.2"></a>8.2 Canonical DNS Name Order</h3>
For purposes of DNS security, the canonical ordering of owner names is
to sort individual labels as unsigned left justified octet strings where
the absence of a octet sorts before a zero value octet and upper case letters
are treated as lower case letters.&nbsp; Names in a zone are sorted by
sorting on the highest level label and then, within those names with the
same highest level label by the next lower label, etc. down to leaf node
labels.&nbsp; Within a zone, the zone name itself always exists and all
other names are the zone name with some prefix of lower level labels.&nbsp;
Thus the zone name itself always sorts first.
<p>Example:
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; foo.example</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; a.foo.example</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; yljkjljk.a.foo.example</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Z.a.foo.example</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; zABC.a.FOO.EXAMPLE</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; z.foo.example</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; *.z.foo.example</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; \200.z.foo.example</tt>
<br>&nbsp;
<h3>
<a NAME="8.3"></a>8.3 Canonical RR Ordering Within An RRset</h3>
Within any particular owner name and type, RRs are sorted by RDATA as a
left justified unsigned octet sequence where the absence of an octet sorts
before the zero octet.
<br>&nbsp;
<h3>
<a NAME="8.4"></a>8.4 Canonical Ordering of RR Types</h3>
When RRs of the same name but different types must be ordered, they are
ordered by type, considering the type to be an unsigned integer, except
that SIG RRs are placed immediately after the type they cover. Thus, for
example, an A record would be put before an MX record because A is type
1 and MX is type 15 but if both were signed, the order would be A &lt;
SIG(A) &lt; MX &lt; SIG(MX).
<br>&nbsp;
<h2>
<a NAME="9"></a>9. Conformance</h2>
Levels of server and resolver conformance are defined below.
<br>&nbsp;
<h3>
<a NAME="9.1"></a>9.1 Server Conformance</h3>
Two levels of server conformance for DNS security are defined as follows:
<p>BASIC:&nbsp; Basic server compliance is the ability to store and retrieve
(including zone transfer) SIG, KEY, and NXT RRs.&nbsp; Any secondary or
caching server for a secure zone MUST have at least basic compliance and
even then some things, such as secure CNAMEs, will not work without full
compliance.
<p>FULL:&nbsp; Full server compliance adds the following to basic compliance:
(1) ability to read SIG, KEY, and NXT RRs in zone files and (2) ability,
given a zone file and private key, to add appropriate SIG and NXT RRs,
possibly via a separate application, (3) proper automatic inclusion of
SIG, KEY, and NXT RRs in responses, (4) suppression of CNAME following
on retrieval of the security type RRs, (5) recognize the CD query header
bit and set the AD query header bit, as appropriate, and (6) proper handling
of the two NXT RRs at delegation points.&nbsp; Primary servers for secure
zones MUST be fully compliant and for complete secure operation, all secondary,
caching, and other servers handling the zone SHOULD be fully compliant
as well.
<br>&nbsp;
<h3>
<a NAME="9.2"></a>9.2 Resolver Conformance</h3>
Two levels of resolver compliance (including the resolver portion of a
server) are defined for DNS Security:
<p>BASIC: A basic compliance resolver can handle SIG, KEY, and NXT RRs
when they are explicitly requested.
<p>FULL: A fully compliant resolver (1) understands KEY, SIG, and NXT RRs
including verification of SIGs at least for the mandatory algorithm, (2)
maintains appropriate information in its local caches and database to indicate
which RRs have been authenticated and to what extent they have been authenticated,
(3) performs additional queries as necessary to attempt to obtain KEY,
SIG, or NXT RRs when needed, (4) normally sets the CD query header bit
on its queries.
<br>&nbsp;
<h2>
<a NAME="10"></a>10. Security Considerations</h2>
This document specifies extensions to the Domain Name System (DNS) protocol
to provide data integrity and data origin authentication, public key distribution,
and optional transaction and request security.
<p>It should be noted that, at most, these extensions guarantee the validity
of resource records, including KEY resource records, retrieved from the
DNS.&nbsp; They do not magically solve other security problems.&nbsp; For
example, using secure DNS you can have high confidence in the IP address
you retrieve for a host name; however, this does not stop someone for substituting
an unauthorized host at that address or capturing packets sent to that
address and falsely responding with packets apparently from that address.&nbsp;
Any reasonably complete security system will require the protection of
many additional facets of the Internet beyond DNS.
<p>The implementation of NXT RRs as described herein enables a resolver
to determine all the names in a zone even if zone transfers are prohibited
(section <a href="#5.6">5.6</a>).&nbsp; This is an active area of work
and may change.
<p>A number of precautions in DNS implementation have evolved over the
years to harden the insecure DNS against spoofing.&nbsp; These precautions
should not be abandoned but should be considered to provide additional
protection in case of key compromise in secure DNS.
<br>&nbsp;
<h2>
<a NAME="11"></a>11. IANA Considerations</h2>
KEY RR flag bits 2 and 8-11 and all flag extension field bits can be assigned
by IETF consensus as defined in <a href="ftp://ftp.is.co.za/rfc/rfc2434.txt">RFC
2434</a>.&nbsp; The remaining values of the NAMTYP flag field and flag
bits 4 and 5 (which could conceivably become an extension of the NAMTYP
field) can only be assigned by an IETF Standards Action [<a href="ftp://ftp.is.co.za/rfc/rfc2434.txt">RFC
2434</a>].
<p>Algorithm numbers 5 through 251 are available for assignment should
sufficient reason arise.&nbsp; However, the designation of a new algorithm
could have a major impact on interoperability and requires an IETF Standards
Action [<a href="ftp://ftp.is.co.za/rfc/rfc2434.txt">RFC 2434</a>].&nbsp;
The existence of the private algorithm types 253 and 254 should satify
most needs for private or proprietary algorithms.
<p>Additional values of the Protocol Octet (5-254) can be assigned by IETF
Consensus [<a href="ftp://ftp.is.co.za/rfc/rfc2434.txt">RFC 2434</a>].
<p>The meaning of the first bit of the NXT RR "type bit map" being a one
can only be assigned by a standards action.
<br>&nbsp;
<h2>
<a NAME="References"></a>References</h2>

<table BORDER=0 CELLSPACING=0 CELLPADDING=0 COLS=2 WIDTH="100%" >
<tr ALIGN=LEFT VALIGN=TOP>
<td WIDTH="10%">[<a href="ftp://ftp.is.co.za/rfc/rfc1033.txt">RFC 1033</a>]</td>

<td>Lottor, M., "Domain Administrators Operations Guide", RFC 1033, November
1987.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>[<a href="ftp://ftp.is.co.za/rfc/rfc1034.txt">RFC 1034</a>]</td>

<td>Mockapetris, P., "Domain Names - Concepts and Facilities", STD 13,
RFC 1034, November 1987.
<br>&nbsp;</td>
</tr>

<tr>
<td ALIGN=LEFT VALIGN=TOP>[<a href="rfc1035/rfc1035.html">RFC 1035</a>]</td>

<td>Mockapetris, P., "Domain Names - Implementation and specifications",
STD 13, RFC 1035, November 1987.
<br>&nbsp;</td>
</tr>

<tr>
<td ALIGN=LEFT VALIGN=TOP>[<a href="ftp://ftp.is.co.za/rfc/rfc1305.txt">RFC
1305</a>]</td>

<td>Mills, D., "Network Time Protocol (v3)", RFC 1305, March 1992.
<br>&nbsp;</td>
</tr>

<tr>
<td ALIGN=LEFT VALIGN=TOP>[<a href="ftp://ftp.is.co.za/rfc/rfc1530.txt">RFC
1530</a>]</td>

<td>Malamud, C. and M. Rose, "Principles of Operation for the TPC.INT Subdomain:
General Principles and Policy", RFC 1530, October 1993.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td ALIGN=LEFT VALIGN=TOP>[<a href="ftp://ftp.is.co.za/rfc/rfc2401.txt">RFC
2401</a>]</td>

<td>Kent, S. and R. Atkinson, "Security Architecture for the Internet Protocol",
RFC 2401, November 1998.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td ALIGN=LEFT VALIGN=TOP>[<a href="rfc1982.html">RFC 1982</a>]</td>

<td>Elz, R. and R. Bush, "Serial Number Arithmetic", RFC 1982, September
1996.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td ALIGN=LEFT VALIGN=TOP>[<a href="rfc1995.html">RFC 1995</a>]</td>

<td>Ohta, M., "Incremental Zone Transfer in DNS", RFC 1995, August 1996.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td ALIGN=LEFT VALIGN=TOP>[<a href="ftp://ftp.is.co.za/rfc/rfc2030.txt">RFC
2030</a>]</td>

<td ALIGN=LEFT VALIGN=TOP>Mills, D., "Simple Network Time Protocol (SNTP)
Version 4 for IPv4, IPv6 and OSI", RFC 2030, October 1996.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td ALIGN=LEFT VALIGN=TOP>[<a href="ftp://ftp.is.co.za/rfc/rfc2045.txt">RFC
2045</a>]</td>

<td ALIGN=LEFT VALIGN=TOP>Freed, N. and N. Borenstein, "Multipurpose Internet
Mail Extensions (MIME) Part One: Format of Internet Message&nbsp; Bodies",
RFC 2045, November 1996.
<br>&nbsp;</td>
</tr>

<tr>
<td ALIGN=LEFT VALIGN=TOP>[<a href="rfc2065.html">RFC 2065</a>]</td>

<td ALIGN=LEFT VALIGN=TOP>Eastlake, D. and C. Kaufman, "Domain Name System
Security Extensions", RFC 2065, January 1997.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td ALIGN=LEFT VALIGN=TOP>[<a href="ftp://ftp.is.co.za/rfc/rfc2119.txt">RFC
2119</a>]</td>

<td ALIGN=LEFT VALIGN=TOP>Bradner, S., "Key words for use in RFCs to Indicate
Requirement Levels", BCP 14, RFC 2119, March 1997.
<br>&nbsp;</td>
</tr>

<tr>
<td>[<a href="rfc2136.html">RFC 2136</a>]</td>

<td ALIGN=LEFT VALIGN=TOP>Vixie, P., Thomson, S., Rekhter, Y. and J. Bound,
"Dynamic Updates in the Domain Name System (DNS UPDATE)", RFC 2136, April
1997.
<br>&nbsp;</td>
</tr>

<tr>
<td ALIGN=LEFT VALIGN=TOP>[<a href="rfc2137.html">RFC 2137</a>]</td>

<td>Eastlake, D., "Secure Domain Name System Dynamic Update",&nbsp; RFC
2137, April 1997.
<br>&nbsp;</td>
</tr>

<tr>
<td ALIGN=LEFT VALIGN=TOP>[<a href="rfc2181.html">RFC 2181</a>]</td>

<td>Elz, R. and R. Bush, "Clarifications to the DNS Specification", RFC
2181, July 1997.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td ALIGN=LEFT VALIGN=TOP>[<a href="ftp://ftp.is.co.za/rfc/rfc2434.txt">RFC
2434</a>]</td>

<td>Narten, T. and H. Alvestrand, "Guidelines for Writing an IANA Considerations
Section in RFCs", BCP 26, RFC 2434, October 1998.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>[<a href="rfc2537.html">RFC 2537</a>]</td>

<td>Eastlake, D., "RSA/MD5 KEYs and SIGs in the Domain Name System (DNS)",
RFC 2537, March 1999.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>[<a href="rfc2539.html">RFC 2539</a>]</td>

<td>Eastlake, D., "Storage of Diffie-Hellman Keys in the Domain Name System
(DNS)", RFC 2539, March 1999.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>[<a href="rfc2536.html">RFC 2536</a>]</td>

<td>Eastlake, D., "DSA KEYs and SIGs in the Domain Name System (DNS)",
RFC 2536, March 1999.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>[<a href="rfc2538.html">RFC 2538</a>]</td>

<td>Eastlake, D. and O. Gudmundsson, "Storing Certificates in the Domain
Name System", RFC 2538, March 1999.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td>[<a href="rfc2541.html">RFC 2541</a>]</td>

<td>Eastlake, D., "DNS Operational Security Considerations", RFC 2541,
March 1999.
<br>&nbsp;</td>
</tr>

<tr ALIGN=LEFT VALIGN=TOP>
<td ALIGN=LEFT VALIGN=TOP>[RSA FAQ]&nbsp;</td>

<td>RSADSI Frequently Asked Questions periodic posting.
<br>&nbsp;</td>
</tr>
</table>

<br>&nbsp;
<h2>
<a NAME="Author"></a>Author's Address</h2>
Donald E. Eastlake 3rd
<br>IBM
<br>65 Shindegan Hill Road
<br>RR #1
<br>Carmel, NY 10512
<p>Phone:&nbsp;&nbsp; +1-914-784-7913 (w)
<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; +1-914-276-2668 (h)
<br>Fax:&nbsp;&nbsp;&nbsp;&nbsp; +1-914-784-3833 (w-fax)
<br>EMail:&nbsp;&nbsp; <a href="mailto:dee3@us.ibm.com">dee3@us.ibm.com</a>
<br>&nbsp;
<h2>
<a NAME="A"></a>Appendix A: Base 64 Encoding</h2>
The following encoding technique is taken from [<a href="ftp://ftp.is.co.za/rfc/rfc2045.txt">RFC
2045</a>] by N. Borenstein and N. Freed.&nbsp; It is reproduced here in
an edited form for convenience.
<p>A 65-character subset of US-ASCII is used, enabling 6 bits to be represented
per printable character. (The extra 65th character, "=", is used to signify
a special processing function.)
<p>The encoding process represents 24-bit groups of input bits as output
strings of 4 encoded characters. Proceeding from left to right, a 24-bit
input group is formed by concatenating 3 8-bit input groups. These 24 bits
are then treated as 4 concatenated 6-bit groups, each of which is translated
into a single digit in the base 64 alphabet.
<p>Each 6-bit group is used as an index into an array of 64 printable characters.
The character referenced by the index is placed in the output string.
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Table 1: The Base 64 Alphabet
<p><tt>&nbsp;&nbsp; Value Encoding&nbsp; Value Encoding&nbsp; Value Encoding&nbsp;
Value Encoding</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0 A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
17 R&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
34 i&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
51 z</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1 B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
18 S&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
35 j&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
52 0</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2 C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
19 T&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
36 k&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
53 1</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3 D&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
20 U&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
37 l&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
54 2</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4 E&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
21 V&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
38 m&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
55 3</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 5 F&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
22 W&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
39 n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
56 4</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 6 G&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
23 X&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
40 o&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
57 5</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 7 H&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
24 Y&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
41 p&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
58 6</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 8 I&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
25 Z&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
42 q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
59 7</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9 J&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
26 a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
43 r&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
60 8</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10 K&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
27 b&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
44 s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
61 9</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 11 L&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
28 c&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
45 t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
62 +</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 12 M&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
29 d&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
46 u&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
63 /</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 13 N&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
30 e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
47 v</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 14 O&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
31 f&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
48 w&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (pad) =</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 15 P&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
32 g&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
49 x</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 16 Q&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
33 h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
50 y</tt>
<p>Special processing is performed if fewer than 24 bits are available
at the end of the data being encoded.&nbsp; A full encoding quantum is
always completed at the end of a quantity.&nbsp; When fewer than 24 input
bits are available in an input group, zero bits are added (on the right)
to form an integral number of 6-bit groups.&nbsp; Padding at the end of
the data is performed using the '=' character.&nbsp; Since all base 64
input is an integral number of octets, only the following cases can arise:
(1) the final quantum of encoding input is an integral multiple of 24 bits;
here, the final unit of encoded output will be an integral multiple of
4 characters with no "=" padding, (2) the final quantum of encoding input
is exactly 8 bits; here, the final unit of encoded output will be two characters
followed by two "=" padding characters, or (3) the final quantum of encoding
input is exactly 16 bits; here, the final unit of encoded output will be
three characters followed by one "=" padding character.
<br>&nbsp;
<h2>
<a NAME="B"></a>Appendix B: Changes from <a href="rfc2065.html">RFC 2065</a></h2>
This section summarizes the most important changes that have been made
since <a href="rfc2065.html">RFC 2065</a>.
<p><b>1.</b>&nbsp;&nbsp; Most of Section 7 of [<a href="rfc2065.html">RFC
2065</a>] called "Operational Considerations", has been removed and may
be made into a separate document [<a href="rfc2541.html">RFC 2541</a>].
<p><b>2.&nbsp;</b>&nbsp; The KEY RR has been changed by (2a) eliminating
the "experimental" flag as unnecessary, (2b) reserving a flag&nbsp; bit
for flags expansion, (2c) more compactly encoding a number of bit fields
in such a way as to leave unchanged bits actually used by the limited code
currently deployed, (2d) eliminating the IPSEC and email flag bits which
are replaced by values of the protocol field and adding a protocol field
value for DNS security itself, (2e) adding material to indicate that zone
KEY RRs occur only at delegation points, and (2f) removing the description
of the RSA/MD5 algorithm to a separate document [<a href="rfc2537.html">RFC
2537</a>].
<a href="#3.4">Section 3.4</a> describing the
<br>meaning of various combinations of "no-key" and key present KEY RRs
has been added and the secure / unsecure status of a zone has been clarified
as being per algorithm.
<p><b>3.</b>&nbsp; The SIG RR has been changed by (3a) renaming the "time
signed" field to be the "signature inception" field, (3b) clarifying that
signature expiration and inception use serial number ring arithmetic, (3c)
changing the definition of the key footprint/tag for algorithms other than
1 and adding <a href="#C">Appendix C</a> to specify its calculation.&nbsp;
In addition, the SIG covering type AXFR has been eliminated while one covering
IXFR [<a href="rfc1995.html">RFC 1995</a>] has been added (see <a href="#5.6">section
5.6</a>).
<p><b>4.&nbsp;</b> Algorithm 3, the DSA algorithm, is now designated as
the mandatory to implement algorithm.&nbsp; Algorithm 1, the RSA/MD5 algorithm,
is now a recommended option.&nbsp; Algorithm 2 and 4 are designated as
the Diffie-Hellman key and elliptic cryptography algorithms respectively,
all to be defined in separate documents. Algorithm code point 252 is designated
to indicate "indirect" keys, to be defined in a separate document, where
the actual key is elsewhere. Both the KEY and SIG RR definitions have been
simplified by eliminating the "null" algorithm 253 as defined in [<a href="rfc2065.html">RFC
2065</a>]. That algorithm had been included because at the time it was
<br>thought it might be useful in DNS dynamic update [<a href="rfc2136.html">RFC
2136</a>]. It was in fact not so used and it is dropped to simplify DNS
security.&nbsp; Howver, that algorithm number has been re-used to indicate
private algorithms where a domain name specifies the algorithm.
<p><b>5.</b> The NXT RR has been changed so that (5a) the NXT RRs in a
zone cover all names, including wildcards as literal names without expansion,
except for glue address records whose names would not otherwise appear,
(5b) all NXT bit map areas whose first octet has bit zero set have been
reserved for future definition, (5c) the number of and circumstances under
which an NXT must be returned in connection with wildcard names has been
extended, and (5d) in connection with the bit map, references to the WKS
RR have been removed and verticle bars ("|") have been added between the
RR type mnemonics in the ASCII representation.
<p><b>6.</b>&nbsp; Information on the canonical form and ordering of RRs
has been moved into a separate <a href="#8">Section 8</a>.
<p><b>7</b>.&nbsp; A subsection covering incremental and full zone transfer
has been added in <a href="#5">Section 5</a>.
<p><b>8.&nbsp;</b> Concerning DNS chaining: Further specification and policy
recommendations on secure resolution have been added, primarily in <a href="#6.3.1">Section
6.3.1</a>.&nbsp; It is now clearly stated that authenticated data has a
validity period of the intersection of the validity periods of the SIG
RRs in its authentication chain.&nbsp; The requirement to staticly configure
a superzone's key signed by a zone in all of the zone's authoritative servers
has been removed.&nbsp; The recommendation to continue DNS security checks
in a secure island of DNS data that is separated from other parts of the
DNS tree by insecure zones and does not contain a zone for which a key
has been staticly configured was dropped.
<p><b>9.</b>&nbsp; It was clarified that the presence of the AD bit in
a response does not apply to the additional information section or to glue
address or delegation point NS RRs.&nbsp; The AD bit only indicates that
the answer and authority sections of the response are authoritative.
<p><b>10.</b>&nbsp; It is now required that KEY RRs and NXT RRs be signed
only with zone-level keys.
<p><b>11</b>.&nbsp;&nbsp; Add IANA Considerations section and references
to <a href="ftp://ftp.is.co.za/rfc/rfc2434.txt">RFC 2434</a>.
<br>&nbsp;
<h2>
<a NAME="C"></a>Appendix C: Key Tag Calculation</h2>
The key tag field in the SIG RR is just a means of more efficiently selecting
the correct KEY RR to use when there is more than one KEY RR candidate
available, for example, in verifying a signature.&nbsp; It is possible
for more than one candidate key to have the same tag, in which case each
must be tried until one works or all fail.&nbsp; The following reference
implementation of how to calculate the Key Tag, for all algorithms other
than algorithm 1, is in ANSI C.&nbsp; It is coded for clarity, not efficiency.&nbsp;
(See <a href="#4.1.6">section 4.1.6</a> for how to determine the Key Tag
of an algorithm 1 key.)
<p><tt>/* assumes int is at least 16 bits</tt>
<br><tt>&nbsp;&nbsp; first byte of the key tag is the most significant
byte of return</tt>
<br><tt>&nbsp;&nbsp; value</tt>
<br><tt>&nbsp;&nbsp; second byte of the key tag is the least significant
byte of</tt>
<br><tt>&nbsp;&nbsp; return value</tt>
<br><tt>&nbsp;&nbsp; */</tt>
<p><tt>int keytag (</tt>
<p><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned char key[],&nbsp;
/* the RDATA part of the KEY RR */</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; unsigned int keysize,
/* the RDLENGTH */</tt>
<br><tt>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; )</tt>
<br><tt>{</tt>
<br><tt>long int&nbsp;&nbsp;&nbsp; ac;&nbsp;&nbsp;&nbsp; /* assumed to
be 32 bits or larger */</tt>
<p><tt>for ( ac = 0, i = 0; i &lt; keysize; ++i )</tt>
<br><tt>&nbsp;&nbsp;&nbsp; ac += (i&amp;1) ? key[i] : key[i]&lt;&lt;8;</tt>
<br><tt>ac += (ac>>16) &amp; 0xFFFF;</tt>
<br><tt>return ac &amp; 0xFFFF;</tt>
<br><tt>}</tt>
<br>&nbsp;
<h2>
<a NAME="Copyright"></a>Full Copyright Statement</h2>
Copyright (C) The Internet Society (1999).&nbsp; All Rights Reserved.
<p>This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it or
assist in its implementation may be prepared, copied, published and distributed,
in whole or in part, without restriction of any kind, provided that the
above copyright notice and this paragraph are included on all such copies
and derivative works.&nbsp; However, this document itself may not be modified
in any way, such as by removing the copyright notice or references to the
Internet Society or other Internet organizations, except as needed for
the purpose of developing Internet standards in which case the procedures
for copyrights defined in the Internet Standards process must be followed,
or as required to translate it into languages other than
<br>English.
<p>The limited permissions granted above are perpetual and will not be
revoked by the Internet Society or its successors or assigns.
<p>This document and the information contained herein is provided on an
"AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING TASK
FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED
TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE
ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR
A PARTICULAR PURPOSE.
</body>
</html>
